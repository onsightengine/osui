/**
 * @description Suey
 * @about       Lightweight JavaScript UI library.
 * @author      Stephens Nunnally <@stevinz>
 * @license     MIT - Copyright (c) 2024 Stephens Nunnally
 * @source      https://github.com/salinityengine/suey
 * @version     v0.1.20
 */
const t="../../files/gui/check.svg",e="../../files/gui/close.svg",s="../../files/gui/empty.svg",i="../../files/gui/expand.svg",n=25,o="0.3em",r={DARK:0,MID:1,LIGHT:2,FADED:3},a={CLASSIC:35020,STEEL:51395,NAVY:1722575,GRAPE:9834228,FLAMINGO:16716781,RUST:11475993,CARROT:16676608,COFFEE:11628315,GOLDEN:13752405,EMERALD:1755682,RANDOM:-1},h={SHADOW:"shadow",DARKNESS:"darkness",BACKGROUND_DARK:"background-dark",BACKGROUND_LIGHT:"background-light",BUTTON_DARK:"button-dark",BUTTON_LIGHT:"button-light",BLACKLIGHT:"blacklight",DARKLIGHT:"darklight",MIDLIGHT:"midlight",HIGHLIGHT:"highlight",TEXT_DARK:"text-dark",TEXT:"text",TEXT_LIGHT:"text-light",ICON_DARK:"icon-dark",ICON:"icon",ICON_LIGHT:"icon-light",COMPLEMENT:"complement",TRIADIC1:"triadic1",TRIADIC2:"triadic2",TRIADIC3:"triadic3",TRIADIC4:"triadic4"},d={TOP:"top",BOTTOM:"bottom",LEFT:"left",RIGHT:"right",TOP_LEFT:"top-left",TOP_RIGHT:"top-right",BOTTOM_LEFT:"bottom-left",BOTTOM_RIGHT:"bottom-right"},l={STRAIGHT:"straight",CURVE:"curve",ZIGZAG:"zigzag"},c={LINES:"lines",DOTS:"dots"},u={INPUT:"input",OUTPUT:"output"};class m{static getVariable(t,e){return(t=String(t)).startsWith("--")||(t="--"+t),e&&e.isElement&&(e=e.dom),e&&e instanceof HTMLElement||(e=document.querySelector(":root")),getComputedStyle(e).getPropertyValue(t)}static setVariable(t,e,s){(t=String(t)).startsWith("--")||(t="--"+t),s&&s.isElement&&(s=s.dom),s&&s instanceof HTMLElement||(s=document.querySelector(":root")),s.style.setProperty(t,e)}static baseSize(){return parseFloat(getComputedStyle(document.querySelector(":root")).fontSize)}static fontSize(t=document.body){return parseFloat(getComputedStyle(t).fontSize)}static guiScale(t=document.body){return m.fontSize(t)/m.baseSize()}static getTextWidth(t,e){const s=document.createElement("canvas").getContext("2d");return s.font=e,s.measureText(t).width}static getFontCssFromElement(t=document.body){return`${getComputedStyle(t).fontWeight||"normal"} ${getComputedStyle(t).fontSize||"16px"} ${getComputedStyle(t).fontFamily||"Arial"}`}static parentElementWithCSS(t,e,s){const i=Array.isArray(s)?s:[s];e=e.replace(/([A-Z])/g,"-$1").toLowerCase(),t.isElement&&t.dom&&(t=t.dom);let n=t.parentElement;for(;n;){const t=(n.ownerDocument||document).defaultView.getComputedStyle(n,null).getPropertyValue(e);if(t)for(let e=0;e<i.length;e++){if(t==i[e])return n}n=n.parentElement}}static parseSize(t){return"string"==typeof t&&(t.includes("%")||t.includes("px")||t.includes("em")||t.includes("rem")||t.includes("ch")||t.includes("ex")||t.includes("cap")||t.includes("vw")||t.includes("vh")||t.includes("vmin")||t.includes("vmax"))?t:parseInt(t)+"px"}static toEm(t,e=document.body){const s=m.parseSize(t);return s.includes("px")?parseFloat(s)/10/m.guiScale(e)+"em":s.includes("em")?s:(console.warn(`Css.toEm: Could not convert to em, unit passed in: ${t}`),size)}static toPx(t,e=document.body,s="w"){const i=m.parseSize(t);if(i.includes("%")){if(e){const i=m.parentElementWithCSS(e,"position",["relative","absolute"]);if(i)return"w"===s?.01*parseFloat(t)*i.offsetWidth+"px":.01*parseFloat(t)*i.offsetHeight+"px"}}else{if(i.includes("px"))return i;if(i.includes("rem"))return parseInt(10*parseFloat(t))+"px";if(i.includes("em"))return parseInt(10*parseFloat(t)*m.guiScale(e))+"px"}return console.warn(`Css.toPx: Could not convert to pixels, unit passed in: ${t}`),parseInt(i)+"px"}}const p={LEFT:"left",CENTER:"center",MIDDLE:"center",RIGHT:"right"},g={LEFT:"left",RIGHT:"right"},f={OVER:"over",UNDER:"under"};class y{static getLeft(t){return t.getBoundingClientRect().left}static getTop(t){return t.getBoundingClientRect().top}static getWidth(t){return t.offsetWidth}static getHeight(t){return t.offsetHeight}static popOver(t,e,s=p.LEFT,i=0,n=0,o=g.RIGHT){return y.popOverUnder(t,e,f.OVER,s,i,n,o)}static popUnder(t,e,s=p.LEFT,i=0,n=0,o=g.RIGHT){return y.popOverUnder(t,e,f.UNDER,s,i,n,o)}static popOverUnder(t,e,s=f.UNDER,i=p.LEFT,n=0,o=0,r=g.RIGHT){let a=window.innerWidth-4,h=window.innerHeight-4;n=n?parseInt(m.toPx(n),10):0,o=o?parseInt(m.toPx(o),10):0;let d=y.getLeft(e)+n;if(i===p.CENTER){d=y.getLeft(e)+(y.getWidth(e)-y.getWidth(t))/2+n}else if(i===p.RIGHT){d=y.getLeft(e)+(y.getWidth(e)-y.getWidth(t))+n}r===g.LEFT&&(a=y.getLeft(e)+y.getWidth(e));let l=d+y.getWidth(t);l>a&&(d-=l-a),d<4&&(d=4);let c=y.getTop(e)+y.getHeight(e)+o,u=y.getTop(e)-y.getHeight(t)-o,v=c+y.getHeight(t);v>h&&(s=f.OVER),u<4&&(s=f.UNDER);let b=s===f.UNDER?c:u;return s===f.UNDER&&(v=b+y.getHeight(t),v>h&&(b=h-y.getHeight(t),b<4&&(b=4))),t.style.left=m.toPx(d),t.style.top=m.toPx(b),s}}class v{static get NAMES(){return K}constructor(t=16777215,e,s,i=""){this.isColor=!0,this.isIris=!0,this.type="Color",this.r=1,this.g=1,this.b=1,this.set(t,e,s,i)}copy(t){return this.set(t)}clone(){return new this.constructor(this.r,this.g,this.b)}set(t=0,e,s,i=""){if(0===arguments.length)return this.set(0);if(null==t||Number.isNaN(t))(e||s)&&console.warn(`Iris: Passed some valid arguments, however 'r' was ${t}`);else if(void 0===e&&void 0===s){let s=t;if("number"==typeof s||0===s)return this.setHex(s);if(s&&(void 0!==(n=s).r&&void 0!==n.g&&void 0!==n.b))return this.setRGBF(s.r,s.g,s.b);if(s&&b(s))return this.setHSL(360*s.h,s.s,s.l);if(s&&w(s))return this.setRYB(255*s.r,255*s.y,255*s.b);if(Array.isArray(s)&&s.length>2){const t=null!=e&&!Number.isNaN(e)&&e>0?e:0;return this.setRGBF(s[t],s[t+1],s[t+2])}if("string"==typeof s)return this.setStyle(s)}else switch(i){case"rgb":return this.setRGB(t,e,s);case"hsl":return this.setHSL(t,e,s);case"ryb":return this.setRYB(t,e,s);default:return this.setRGBF(t,e,s)}var n;return this}setColorName(t){const e=K[t.toLowerCase()];return e?this.setHex(e):(console.warn(`Iris: Unknown color ${t}`),this)}setHex(t){((t=Math.floor(t))>16777215||t<0)&&(console.warn(`Iris: Given decimal outside of range, value was ${t}`),t=x(t,0,16777215));const e=(16711680&t)>>16,s=(65280&t)>>8,i=255&t;return this.setRGB(e,s,i)}setHSL(t,e,s){t=M(t,0,360),e=x(e,0,1),s=x(s,0,1);let i=(1-Math.abs(2*s-1))*e,n=i*(1-Math.abs(t/60%2-1)),o=s-i/2,r=0,a=0,h=0;return t<60?(r=i,a=n,h=0):60<=t&&t<120?(r=n,a=i,h=0):120<=t&&t<180?(r=0,a=i,h=n):180<=t&&t<240?(r=0,a=n,h=i):240<=t&&t<300?(r=n,a=0,h=i):300<=t&&(r=i,a=0,h=n),this.setRGBF(r+o,a+o,h+o),this}setRandom(){return this.setRGBF(Math.random(),Math.random(),Math.random())}setRGB(t,e,s){return this.setRGBF(t/255,e/255,s/255)}setRGBF(t,e,s){return this.r=x(t,0,1),this.g=x(e,0,1),this.b=x(s,0,1),this}setRYB(t,e,s){const i=z(x(t,0,255),x(e,0,255),x(s,0,255),255,W.RYB_TO_RGB);return this.setHex(i)}setScalar(t){return this.setRGB(t,t,t)}setScalarF(t){return this.setRGBF(t,t,t)}setStyle(t){let e;if(e=/^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(t)){let t;const s=e[1],i=e[2];switch(s){case"rgb":case"rgba":if(t=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(i)){const e=Math.min(255,parseInt(t[1],10)),s=Math.min(255,parseInt(t[2],10)),i=Math.min(255,parseInt(t[3],10));return this.setRGB(e,s,i)}if(t=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(i)){const e=Math.min(100,parseInt(t[1],10))/100,s=Math.min(100,parseInt(t[2],10))/100,i=Math.min(100,parseInt(t[3],10))/100;return this.setRGBF(e,s,i)}break;case"hsl":case"hsla":if(t=/^\s*(\d*\.?\d+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(i)){const e=parseFloat(t[1]),s=parseInt(t[2],10)/100,i=parseInt(t[3],10)/100;return this.setHSL(e,s,i)}}}else if(e=/^\#([A-Fa-f\d]+)$/.exec(t)){const t=e[1],s=t.length;if(3===s){const e=parseInt(t.charAt(0)+t.charAt(0),16),s=parseInt(t.charAt(1)+t.charAt(1),16),i=parseInt(t.charAt(2)+t.charAt(2),16);return this.setRGB(e,s,i)}if(6===s){const e=parseInt(t.charAt(0)+t.charAt(1),16),s=parseInt(t.charAt(2)+t.charAt(3),16),i=parseInt(t.charAt(4)+t.charAt(5),16);return this.setRGB(e,s,i)}}return t&&t.length>0?this.setColorName(t):this}cssString(t){return"rgb("+this.rgbString(t)+")"}hex(){return(this.red()<<16)+(this.green()<<8)+this.blue()}hexString(t){return t&&this.set(t),v.hexString(this.hex())}static hexString(t=0){return G.set(t),"#"+("000000"+(G.hex()>>>0).toString(16)).slice(-6)}static randomHex(){return $.setRandom().hex()}rgbString(t){const e=this.red()+", "+this.green()+", "+this.blue();return null!=t?String(e+", "+t):e}toJSON(){return this.hex()}getHSL(t){if(!t||!b(t))return{h:L(this.hex()),s:I(this.hex()),l:k(this.hex())};t.h=L(this.hex()),t.s=I(this.hex()),t.l=k(this.hex())}getRGB(t){if(!t||!b(t))return{r:this.r,g:this.g,b:this.b};t.r=this.r,t.g=this.g,t.b=this.b}getRYB(t){let e=z(this.r,this.g,this.b,1,W.RGB_TO_RYB);return t&&w(t)?(t.r=C(e),t.y=E(e),t.b=S(e),t):{r:C(e),y:E(e),b:S(e)}}toArray(t=[],e=0){return t[e]=this.r,t[e+1]=this.g,t[e+2]=this.b,t}red(){return x(Math.floor(255*this.r),0,255)}green(){return x(Math.floor(255*this.g),0,255)}blue(){return x(Math.floor(255*this.b),0,255)}redF(){return this.r}greenF(){return this.g}blueF(){return this.b}hue(){return T(this.hex())}saturation(){return I(this.hex())}lightness(){return k(this.hex())}hueF(){return L(this.hex())}hueRYB(){for(let t=1;t<_.length;t++)if(_[t]>this.hue())return t-2}add(t){return t.isColor||console.warn("Iris: add() was not called with a 'Color' object"),this.setRGBF(this.r+t.r,this.g+t.g,this.b+t.b)}addScalar(t){return this.setRGB(this.red()+t,this.green()+t,this.blue()+t)}addScalarF(t){return this.setRGBF(this.r+t,this.g+t,this.b+t)}brighten(t=.5){let e=T(this.hex()),s=I(this.hex()),i=k(this.hex());return i+=(1-i)*t,this.setHSL(e,s,i),this}darken(t=.5){let e=T(this.hex()),s=I(this.hex()),i=k(this.hex())*t;return this.setHSL(e,s,i)}greyscale(t=1,e="luminosity"){return this.grayscale(t,e)}grayscale(t=1,e="luminosity"){let s=0;"luminosity"===e&&(s=.21*this.r+.72*this.g+.07*this.b),s=(this.r+this.g+this.b)/3,t=x(t,0,1);const i=this.r*(1-t)+t*s,n=this.g*(1-t)+t*s,o=this.b*(1-t)+t*s;return this.setRGBF(i,n,o)}hslOffset(t,e,s){return this.setHSL(this.hue()+t,this.saturation()+e,this.lightness()+s)}mix(t,e=.5){t.isColor||console.warn("Iris: mix() was not called with a 'Color' object"),e=x(e,0,1);const s=this.r*(1-e)+e*t.r,i=this.g*(1-e)+e*t.g,n=this.b*(1-e)+e*t.b;return this.setRGBF(s,i,n)}multiply(t){return t.isColor||console.warn("Iris: multiply() was not called with a 'Color' object"),this.setRGBF(this.r*t.r,this.g*t.g,this.b*t.b)}multiplyScalar(t){return this.setRGBF(this.r*t,this.g*t,this.b*t)}rgbComplementary(){return this.rgbRotateHue(180)}rgbRotateHue(t=90){const e=M(this.hue()+t);return this.setHSL(e,this.saturation(),this.lightness())}rybAdjust(){return this.setHSL(T(V(this.hue(),U.RYB)),this.saturation(),this.lightness())}rybComplementary(){return this.rybRotateHue(180)}rybRotateHue(t=90){const e=M(this.hueRYB()+t);return this.setHSL(T(V(e,U.RYB)),this.saturation(),this.lightness())}subtract(t){return t.isColor||console.warn("Iris: subtract() was not called with a 'Color' object"),this.setRGBF(this.r-t.r,this.g-t.g,this.b-t.b)}equals(t){return t.isColor||console.warn("Iris: equals() was not called with a 'Color' object"),R(this.r,t.r)&&R(this.g,t.g)&&R(this.b,t.b)}isEqual(t){return this.equals(t)}isDark(){const t=this.hue(),e=this.lightness();return e<.6&&(t>=210||t<=27)||e<=.32}isLight(){return!this.isDark()}}function b(t){return void 0!==t.h&&void 0!==t.s&&void 0!==t.l}function w(t){return void 0!==t.r&&void 0!==t.y&&void 0!==t.b}function x(t,e,s){return Math.max(e,Math.min(s,t))}function C(t){return function(t){return x((16711680&t)>>16,0,255)}(t)/255}function E(t){return function(t){return x((65280&t)>>8,0,255)}(t)/255}function S(t){return function(t){return x(255&t,0,255)}(t)/255}function T(t){return P(t,"h")}function L(t){return T(t)/360}function I(t){return P(t,"s")}function k(t){return P(t,"l")}function R(t,e,s=.0015){return t<e+s&&t>e-s}function M(t,e=0,s=360){for(;t>=s;)t-=s-e;for(;t<e;)t+=s-e;return t}let D,H,A,N;function P(t,e="h"){if(t!==D){if(null==t)return 0;const e=C(t),s=E(t),i=S(t),n=Math.max(e,s,i),o=Math.min(e,s,i),r=n-o;if(N=(n+o)/2,0===r)H=A=0;else{switch(A=N<=.5?r/(n+o):r/(2-n-o),n){case e:H=(s-i)/r+(s<i?6:0);break;case s:H=(i-e)/r+2;break;case i:H=(e-s)/r+4}H=Math.round(60*H),H<0&&(H+=360)}D=t}switch(e){case"h":return H;case"s":return A;case"l":return N;default:console.warn(`Iris: Unknown channel (${e}) requested in hsl()`)}return 0}const O=new v,F=new v,B=new v,$=new v,G=new v;function V(t,e=U.RYB){let s=360/e.length,i=s,n=0;for(let o=0;o<e.length;o++){if(t<i){let o=(i-t)/s;return F.set(e[n+1]),F.mix(B.set(e[n]),o).hex()}i+=s,n+=1}}function z(t,e,s,i=255,n=W.RYB_TO_RGB){t=x(t/i,0,1),e=x(e/i,0,1),s=x(s/i,0,1);const o=n[0],r=n[1],a=n[2],h=n[3],d=n[4],l=n[5],c=n[6],u=n[7],m=1-t,p=1-e,g=1-s,f=m*p*g,y=m*p*s,v=m*e*g,b=t*p*g,w=m*e*s,C=t*p*s,E=t*e*g,S=t*e*s,T=f*o[0]+y*r[0]+v*a[0]+b*h[0]+w*d[0]+C*l[0]+E*c[0]+S*u[0],L=f*o[1]+y*r[1]+v*a[1]+b*h[1]+w*d[1]+C*l[1]+E*c[1]+S*u[1],I=f*o[2]+y*r[2]+v*a[2]+b*h[2]+w*d[2]+C*l[2]+E*c[2]+S*u[2];return O.set(T,L,I,"gl").hex()}const W={RYB_TO_RGB:[[1,1,1],[.163,.373,.6],[1,1,0],[1,0,0],[0,.66,.2],[.5,0,.5],[1,.5,0],[0,0,0]],RGB_TO_RYB:[[1,1,1],[0,0,1],[0,1,.483],[1,0,0],[0,.053,.21],[.309,0,.469],[0,1,0],[0,0,0]]},U={RYB:[16711680,16730368,16741376,16749056,16755200,16760576,16765696,16771072,16776960,13432320,10481152,6808320,52224,44900,39321,745892,1196203,1776563,3740847,5443501,7408042,10879142,13434996,14942277,16711680]},_=[0,1,2,3,5,6,7,8,9,10,11,13,14,15,16,17,18,19,19,20,21,21,22,23,23,24,25,25,26,27,27,28,28,29,29,30,30,31,31,32,32,32,33,33,34,34,35,35,35,36,36,37,37,37,38,38,38,39,39,40,40,40,41,41,41,42,42,42,43,43,43,44,44,44,45,45,45,46,46,46,47,47,47,47,48,48,48,49,49,49,50,50,50,51,51,51,52,52,52,53,53,53,54,54,54,55,55,55,56,56,56,57,57,57,58,58,59,59,59,60,60,61,61,62,63,63,64,65,65,66,67,68,68,69,70,70,71,72,72,73,73,74,75,75,76,77,77,78,79,79,80,81,82,82,83,84,85,86,87,88,88,89,90,91,92,93,95,96,98,100,102,104,105,107,109,111,113,115,116,118,120,122,125,127,129,131,134,136,138,141,143,145,147,150,152,154,156,158,159,161,163,165,166,168,170,171,173,175,177,178,180,182,184,185,187,189,191,192,194,196,198,199,201,203,205,206,207,208,209,210,212,213,214,215,216,217,218,219,220,221,222,223,224,226,227,228,229,230,232,233,234,235,236,238,239,240,241,242,243,244,245,246,247,248,249,250,251,251,252,253,254,255,256,257,257,258,259,260,260,261,262,263,264,264,265,266,267,268,268,269,270,271,272,273,274,274,275,276,277,278,279,280,282,283,284,286,287,289,290,292,293,294,296,297,299,300,302,303,305,307,309,310,312,314,316,317,319,321,323,324,326,327,328,329,330,331,332,333,334,336,337,338,339,340,341,342,343,344,345,347,348,349,350,352,353,354,355,356,358,359,999],K={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,transparent:0,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Y=new v,X=new v,q=new v,Z=new v,j=new v,J=new v,Q=new v,tt=new v,et=new v;let st=r.DARK,it=35020,nt=0,ot=0;class rt{static changeBackground(t){null!=t&&(st=t,rt.updateCSS())}static changeColor(t,e,s){null!=t&&(it=Y.set(t).hex(),nt=void 0!==e?e:nt,ot=void 0!==s?s:ot,X.set(t),q.copy(X).brighten(),Z.copy(X).darken(),j.copy(X).rybRotateHue(180).brighten(.2),J.copy(X).rybRotateHue(120).brighten(.2),Q.copy(j).rybRotateHue(120).brighten(.2),tt.copy(X).rybRotateHue(90).brighten(.2),et.copy(j).rybRotateHue(90).brighten(.2),rt.updateCSS())}static updateCSS(){m.setVariable("--shadow",Y.set(rt.color(h.SHADOW)).rgbString()),m.setVariable("--darkness",Y.set(rt.color(h.DARKNESS)).rgbString()),m.setVariable("--background-dark",Y.set(rt.color(h.BACKGROUND_DARK)).rgbString()),m.setVariable("--background-light",Y.set(rt.color(h.BACKGROUND_LIGHT)).rgbString()),m.setVariable("--button-dark",Y.set(rt.color(h.BUTTON_DARK)).rgbString()),m.setVariable("--button-light",Y.set(rt.color(h.BUTTON_LIGHT)).rgbString()),m.setVariable("--text-dark",Y.set(rt.color(h.TEXT_DARK)).rgbString()),m.setVariable("--text",Y.set(rt.color(h.TEXT)).rgbString()),m.setVariable("--text-light",Y.set(rt.color(h.TEXT_LIGHT)).rgbString()),m.setVariable("--blacklight",Y.set(rt.color(h.BLACKLIGHT)).rgbString()),m.setVariable("--darklight",Y.set(rt.color(h.DARKLIGHT)).rgbString()),m.setVariable("--midlight",Y.set(rt.color(h.MIDLIGHT)).rgbString()),m.setVariable("--highlight",Y.set(rt.color(h.HIGHLIGHT)).rgbString()),m.setVariable("--icon-dark",Y.set(rt.color(h.ICON_DARK)).rgbString()),m.setVariable("--icon",Y.set(rt.color(h.ICON)).rgbString()),m.setVariable("--icon-light",Y.set(rt.color(h.ICON_LIGHT)).rgbString()),m.setVariable("--complement",Y.set(rt.color(h.COMPLEMENT)).rgbString()),m.setVariable("--triadic1",Y.set(rt.color(h.TRIADIC1)).rgbString()),m.setVariable("--triadic2",Y.set(rt.color(h.TRIADIC2)).rgbString()),m.setVariable("--triadic3",Y.set(rt.color(h.TRIADIC3)).rgbString()),m.setVariable("--triadic4",Y.set(rt.color(h.TRIADIC4)).rgbString()),m.setVariable("--bright",st==r.LIGHT?"0":"1");const t=Y.set(35020).hue(),e=Y.set(rt.color(h.ICON,!0)).hue()-t+30+"deg";m.setVariable("--rotate-hue",e)}static color(t,e=!1){Y.set(0);let s=nt,i=ot,n=0;switch(st){case r.DARK:break;case r.MID:s*=.2,n=.2;break;case r.LIGHT:break;case r.FADED:s*=.1,n=.4}if(st==r.LIGHT)switch(t){case h.SHADOW:Y.set(140,140,140,"rgb");break;case h.BACKGROUND_DARK:Y.set(180,180,180,"rgb");break;case h.BACKGROUND_LIGHT:Y.set(190,190,190,"rgb");break;case h.BUTTON_DARK:Y.set(200,200,200,"rgb");break;case h.BUTTON_LIGHT:Y.set(210,210,210,"rgb");break;case h.TEXT_DARK:Y.set(80,80,80,"rgb");break;case h.TEXT:Y.set(50,50,50,"rgb");break;case h.TEXT_LIGHT:Y.set(25,25,25,"rgb");break;case h.BLACKLIGHT:Y.set(255,255,255,"rgb");break;case h.DARKLIGHT:Y.set(200,200,200,"rgb");break;case h.MIDLIGHT:Y.set(220,220,220,"rgb");break;case h.HIGHLIGHT:Y.set(0,0,0,"rgb")}else{switch(t){case h.SHADOW:Y.set(0,0,0,"rgb"),s=0;break;case h.BACKGROUND_DARK:Y.set(24,24,24,"rgb");break;case h.BACKGROUND_LIGHT:Y.set(32,32,32,"rgb");break;case h.BUTTON_DARK:Y.set(40,40,40,"rgb");break;case h.BUTTON_LIGHT:Y.set(60,60,60,"rgb");break;case h.TEXT_DARK:Y.set(100,100,100,"rgb");break;case h.TEXT:Y.set(190,190,190,"rgb");break;case h.TEXT_LIGHT:Y.set(225,225,225,"rgb");break;case h.BLACKLIGHT:Y.set(0,0,0,"rgb"),n=0;break;case h.DARKLIGHT:Y.set(8,8,8,"rgb"),n=0;break;case h.MIDLIGHT:Y.set(85,85,85,"rgb");break;case h.HIGHLIGHT:Y.set(255,255,255,"rgb")}st==r.MID&&t==h.DARKLIGHT&&Y.set(64,64,64,"rgb")}if(t===h.DARKNESS)switch(st){case r.DARK:Y.set(0,0,0,"rgb");break;case r.MID:Y.set(64,64,64,"rgb");break;case r.LIGHT:Y.set(128,128,128,"rgb");break;case r.FADED:Y.set(0,0,0,"rgb")}switch(t){case h.ICON_DARK:Y.copy(Z);break;case h.ICON:Y.copy(X);break;case h.ICON_LIGHT:Y.copy(q);break;case h.COMPLEMENT:Y.copy(j);break;case h.TRIADIC1:Y.copy(J);break;case h.TRIADIC2:Y.copy(Q);break;case h.TRIADIC3:Y.copy(tt);break;case h.TRIADIC4:Y.copy(et)}switch(t){case h.COMPLEMENT:case h.TRIADIC1:case h.TRIADIC2:case h.TRIADIC3:case h.TRIADIC4:i=0;case h.ICON_DARK:case h.ICON:case h.ICON_LIGHT:s=0,n=0}return 0!==s&&Y.mix(X,s),0!==n&&Y.brighten(n),0===i||e||Y.hslOffset(0,i,0),Y.hex()}}class at{active=!0;params=null;onceOnly=!1;constructor(t,e,s,i=0){this.listener=e,this.onceOnly=s,this.signal=t,this.priority=i}execute(t){let e,s;return this.active&&this.listener&&(s=this.params?this.params.concat(t):t,e=this.listener.apply(null,s),this.onceOnly&&this.detach()),e}detach(){return this.isBound()?this.signal.remove(this.listener):null}isBound(){return!!this.signal&&!!this.listener}isOnce(){return this.onceOnly}getListener(){return this.listener}getSignal(){return this.signal}destroy(){delete this.signal,delete this.listener}toString(){return"[SignalBinding onceOnly:"+this.onceOnly+", isBound:"+this.isBound()+", active:"+this.active+"]"}}class ht{VERSION="1.0.2";active=!0;memorize=!1;shouldPropagate=!0;constructor(){this._bindings=[],this._prevParams=null}#t(t,e,s){let i,n=this.#e(t);if(-1!==n){if(i=this._bindings[n],i.isOnce()!==e)throw new Error("You cannot add"+(e?"":"Once")+"() then add"+(e?"Once":"")+"() the same listener without removing the relationship first")}else{i=new at(this,t,e,s);let n=this._bindings.length;do{--n}while(this._bindings[n]&&i.priority<=this._bindings[n].priority);this._bindings.splice(n+1,0,i)}return this.memorize&&this._prevParams&&i.execute(this._prevParams),i}#e(t){let e,s=this._bindings.length;for(;s--;)if(e=this._bindings[s],e.listener===t)return s;return-1}has(t){return-1!==this.#e(t)}add(t,e){return dt(t,"add"),this.#t(t,!1,e)}addOnce(t,e){return dt(t,"addOnce"),this.#t(t,!0,e)}remove(t){dt(t,"remove");const e=this.#e(t);return-1!==e&&(this._bindings[e].destroy(),this._bindings.splice(e,1)),t}removeAll(){let t=this._bindings.length;for(;t--;)this._bindings[t].destroy();this._bindings.length=0}getNumListeners(){return this._bindings.length}halt(){this.shouldPropagate=!1}dispatch(){if(!this.active)return;let t=[...arguments],e=this._bindings.length;if(this.memorize&&(this._prevParams=t),!e)return;const s=[...this._bindings];this.shouldPropagate=!0;do{e--}while(s[e]&&this.shouldPropagate&&!1!==s[e].execute(t))}forget(){this._prevParams=null}dispose(){this.removeAll(),delete this._bindings,delete this._prevParams}toString(){return"[Signal active:"+this.active+" numListeners:"+this.getNumListeners()+"]"}}function dt(t,e){if("function"!=typeof t)throw new Error(`'listener' is a required param of ${e}() and should be a Function!`)}class lt{constructor(t){const e=this;this.isElement=!0,this.dom=t,this.name=void 0,this.contents=function(){return e},this.children=[],this.parent=void 0,this.slots=[],this.dom.addEventListener("destroy",(function(){for(const t of e.slots)"function"==typeof t.detach&&t.detach(),"function"==typeof t.destroy&&t.destroy();e.slots.length=0}),{once:!0})}destroy(){return mt(this,!0),this}addSlot(t){t instanceof at?this.slots.push(t):console.warn(`Element.addSlot(): '${this.name}' failed to add slot`,t)}add(){for(let t=0;t<arguments.length;t++){const e=arguments[t];ct(this.contents(),e)}return this}addToSelf(){for(let t=0;t<arguments.length;t++){ct(this,arguments[t])}return this}clearContents(){return mt(this.contents(),!1),this}remove(){for(let t=0;t<arguments.length;t++){const e=arguments[t];let s=pt(this.contents(),e);s||(s=pt(this,e))}return this}setClass(t){return this.dom.className=t,this}addClass(){for(let t=0;t<arguments.length;t++){const e=arguments[t];this.dom.classList.add(e)}return this}hasClass(t){return this.dom.classList.contains(t)}hasClassWithString(t){t=String(t).toLowerCase();const e=[...this.dom.classList];for(let s=0;s<e.length;s++){if(e[s].toLowerCase().includes(t))return!0}return!1}removeClass(){for(let t=0;t<arguments.length;t++){const e=arguments[t];this.dom.classList.remove(e)}return this}setId(t){return this.dom.id=t,void 0===this.name&&(this.name=t),this}getId(){return this.dom.id}setName(t){return this.name=t,this}getName(){return void 0===this.name?"No name":this.name}setAttribute(t,e){this.dom.setAttribute(t,e)}setDisabled(t=!0){return t?this.addClass("suey-disabled"):this.removeClass("suey-disabled"),this.dom.disabled=t,this}selectable(t){return t?this.removeClass("suey-unselectable"):this.addClass("suey-unselectable"),this}hide(t=!0){this.setStyle("display","none"),t&&this.dom.dispatchEvent(new Event("hidden"))}display(t=!0){this.setStyle("display",""),t&&this.dom.dispatchEvent(new Event("displayed"))}isDisplayed(){return"none"!=getComputedStyle(this.dom).display}isHidden(){return"none"==getComputedStyle(this.dom).display}allowFocus(){this.dom.tabIndex=0}focus(){this.dom.focus()}blur(){this.dom.blur()}setTextContent(t){return null!=t&&(this.contents().dom.textContent=t),this}getTextContent(){return this.contents().dom.textContent}setInnerHtml(t){return null==t&&(t=""),"function"==typeof this.contents().dom.setHTML?this.contents().dom.setHTML(t):this.contents().dom.innerHTML=t,this}getInnerHtml(){return this.contents().dom.innerHTML}setStyle(){for(let t=0,e=arguments.length;t<e;t+=2){const e=arguments[t],s=arguments[t+1];this.dom.style[e]=s}return this}setContentsStyle(){for(let t=0,e=arguments.length;t<e;t+=2){const e=arguments[t],s=arguments[t+1];this.contents().dom.style[e]=s}return this}getLeft(){return this.dom.getBoundingClientRect().left}getTop(){return this.dom.getBoundingClientRect().top}getWidth(){return this.dom.getBoundingClientRect().width}getHeight(){return this.dom.getBoundingClientRect().height}traverse(t,e=!0){if(e&&t(this),this.children)for(let e=0;e<this.children.length;e++)this.children[e].traverse(t,!0)}}function ct(t,e){if(e)if(e.isElement){t.dom.appendChild(e.dom);let s=!1;for(const i of t.children)if(i.dom.isSameNode(e.dom)){s=!0;break}s||t.children.push(e),e.parent=t}else try{t.dom.appendChild(e)}catch(t){}}function ut(t){if(t.children)for(let e=t.children.length-1;e>=0;e--){const s=t.children[e];mt(s,!0);try{t.removeChild(s)}catch(t){}}}function mt(t,e=!0){t&&(t.isElement?(!function(t){for(let e=0;e<t.children.length;e++)mt(t.children[e],!0);t.children.length=0}(t),ut(t.dom),e&&t.dom&&t.dom.dispatchEvent&&t.dom.dispatchEvent(new Event("destroy"))):(ut(t),e&&t&&t.dispatchEvent&&t.dispatchEvent(new Event("destroy"))))}function pt(t,e){if(t&&e){if(e.isElement&&t.isElement)for(let s=0;s<t.children.length;s++){t.children[s].dom.isSameNode(e.dom)&&(t.children.splice(s,1),e.parent=void 0)}mt(e);try{return t.isElement?t.dom.removeChild(e.isElement?e.dom:e):t.removeChild(e.isElement?e.dom:e),!0}catch(t){return!1}}}["display","color","opacity","left","top","right","bottom","width","height"].forEach((function(t){const e="set"+t.substring(0,1).toUpperCase()+t.substring(1,t.length);lt.prototype[e]=function(e){return this.setStyle(t,e),this}})),Object.defineProperties(lt.prototype,{id:{get:function(){return this.getId()},set:function(t){this.setId(t)}}});["Focus","Blur","Change","Input","Wheel","KeyUp","KeyDown","Click","DblClick","ContextMenu","PointerDown","PointerMove","PointerUp","PointerEnter","PointerLeave","PointerOut","PointerOver","PointerCancel"].forEach((function(t){const e="on"+t;lt.prototype[e]=function(s){const i=t.toLowerCase();if("function"!=typeof s)return console.warn(`${e} in ${this.name}: No callback function provided!`),this;const n=s.bind(this),o=this.dom;return o.addEventListener(i,n),o.addEventListener("destroy",(()=>o.removeEventListener(i,n)),{once:!0}),this}}));class gt extends lt{constructor(t){super(document.createElement("button"));const e=this;function s(t){const s=new Event("hidetooltip",{bubbles:!0});e.dom.dispatchEvent(s)}this.setClass("suey-button"),this.dom.textContent=t??" ",this.attachedMenu=void 0,this.menuOffsetX=0,this.menuOffsetY=0,this.alignMenu=p.LEFT,this.overflowMenu=g.RIGHT,Object.defineProperty(this,"disabled",{get:function(){return!this.dom||this.dom.disabled},set:function(t){this.dom&&(this.dom.disabled=t)}}),this.dom.addEventListener("pointerdown",s),this.dom.addEventListener("destroy",(function(){e.dom.removeEventListener("pointerdown",s),e.attachedMenu&&e.detachMenu()}),{once:!0})}attachMenu(t,e=!1){const s=this;function i(e){e.stopPropagation(),e.preventDefault(),!1===s.hasClass("suey-selected")&&(s.addClass("suey-selected"),n(),setTimeout((()=>{s.dom&&t.showMenu(s.dom,!0)}),0)),document.dispatchEvent(new Event("closemenu"))}function n(){const e=y.popUnder(t.dom,s.dom,s.alignMenu,s.menuOffsetX,s.menuOffsetY,s.overflowMenu);t.removeClass("suey-slide-up"),t.removeClass("suey-slide-down"),t.addClass(e===f.UNDER?"suey-slide-down":"suey-slide-up")}if(e&&t.addClass("suey-popup-menu"),!1===t.hasClass("suey-menu"))return this;this.addClass("suey-menu-button"),this.attachedMenu=t,document.body.appendChild(t.dom),this.dom.addEventListener("pointerdown",i);new MutationObserver(((t,e)=>{document.contains(this.dom)&&(n(),e.disconnect())})).observe(document,{attributes:!1,childList:!0,characterData:!1,subtree:!0}),window.addEventListener("resize",n),this.detachMenu=function(){!1!==s.hasClass("suey-menu-button")&&(s.removeClass("suey-menu-button"),window.removeEventListener("resize",n),s.dom.removeEventListener("pointerdown",i),s.attachedMenu.destroy(),document.body.removeChild(s.attachedMenu.dom),s.attachedMenu=void 0)}}}class ft extends lt{constructor(t){super(document.createElement("div")),this.setInnerHtml(t)}}class yt extends lt{constructor(t,e=null,s=null,i=!1){const n=document.createElement("img");n.onerror=()=>n.style.visibility="hidden",i||(n.ondragstart=()=>!1),null!=e&&(n.style.width=m.parseSize(e)),null!=s&&(n.style.height=m.parseSize(s)),super(n),this.setClass("suey-image"),this.setImage(t)}setImage(t){if("string"==typeof t&&t.toLowerCase().includes("<svg")){const e=new Blob([t],{type:"image/svg+xml"}),s=URL.createObjectURL(e);this.dom.src=s,this.dom.addEventListener("load",(()=>URL.revokeObjectURL(s)),{once:!0})}else this.dom.src=t;return this}}class vt extends ft{constructor(){if(super(),this.setClass("suey-vector-box"),this.img=void 0,0===arguments.length)return this.addImage(s);const t=Array.isArray(arguments[0])?arguments[0]:[...arguments];for(const e of t)this.addImage(e)}firstImage(){for(const t of this.contents().children)if(t&&t.isElement&&t.hasClass("suey-image"))return t}addImage(t=s){const e=new yt(t,"100%","100%",!1);return this.img||(this.img=e),this.add(e),this}enableDragging(){this.dom&&(this.dom.draggable=!0);for(const t of this.contents().children)t.isElement&&t.dom&&(t.dom.ondragstart=()=>{});return this}setImage(t){return this.img.setImage(t)}}class bt extends ft{constructor(){if(super(),this.setClass("suey-shadow-box"),this.addClass("suey-drop-shadow"),0===arguments.length)return;const t=Array.isArray(arguments[0])?arguments[0]:[...arguments];for(const e of t)this.add(e&&e.isElement?e:new vt(e))}firstImage(){for(const t of this.contents().children)if(t&&t.isElement&&(t.hasClass("suey-image")||t.hasClass("suey-vector-box")))return t}fullSize(){return this.addClass("suey-full-size"),this}dropShadow(){return this.addClass("suey-drop-shadow"),this.removeClass("suey-even-shadow"),this}evenShadow(){return this.removeClass("suey-drop-shadow"),this.addClass("suey-even-shadow"),this}noShadow(){return this.removeClass("suey-drop-shadow"),this.removeClass("suey-even-shadow"),this}}const wt={LEFT:"left",RIGHT:"right",BOTH:"both",NONE:"none"},xt="close",Ct="max";class Et{static addCloseButton(t,e=wt.BOTH,s=0,i=1.3){Et.addCornerButton(xt,t,e,s,i)}static addMaxButton(t,e=wt.BOTH,s=0,i=1.3){Et.addCornerButton(Ct,t,e,s,i)}static addCornerButton(t=xt,s,n,o=0,r=1.3){if(!s||!s.isElement)return void console.warn("Interaction.addCornerButton: Missing element argument");const a=new gt;let h,d,l;switch(a.setClass("suey-corner-button"),a.addClass("suey-panel-button"),t){case xt:a.setStyle("background-color","#e24c4b"),h=e,d="Close Panel",l=0;break;case Ct:a.setStyle("background-color","#2bc840"),h=i,d="Toggle Panel",l=1.2}const c=new bt(h).evenShadow().fullSize().addClass("suey-corner-image");a.add(c),a.dom.setAttribute("tooltip",d),a.setStyle("min-height",`${r}em`,"min-width",`${r}em`);const u=`${.8-(r+.28571)/2+o+l*r}em`;if(a.setStyle("top",.8-(r+.28571)/2+"em"),a.setStyle(n===wt.LEFT?"left":"right",u),n===wt.BOTH){let t=wt.RIGHT;s.dom.addEventListener("pointermove",(function(e){const i=s.dom.getBoundingClientRect(),n=i.left+i.width/2,o=e.pageX;let r=wt.NONE;o>n&&t!==wt.RIGHT?r=wt.RIGHT:o<n&&t!==wt.LEFT&&(r=wt.LEFT),r!==wt.NONE&&(a.addClass("suey-item-hidden"),setTimeout((()=>{a.dom.style.removeProperty("left"),a.dom.style.removeProperty("right"),a.setStyle(r,u),a.removeClass("suey-item-hidden")}),100),t=r)}))}switch(t){case xt:a.dom.addEventListener("click",(()=>{s.hide()}));break;case Ct:a.dom.addEventListener("click",(()=>{"function"==typeof s.toggleMinMax&&s.toggleMinMax()}))}s.dom.addEventListener("pointerenter",(()=>a.addClass("suey-item-shown"))),s.dom.addEventListener("pointerleave",(()=>a.removeClass("suey-item-shown"))),s.addToSelf(a)}static makeDraggable(t,e=t,s=!1,i=(()=>{}),n=(()=>{}),o=(()=>{})){const r=t&&t.isElement?t.dom:t,a=e&&e.isElement?e.dom:e;let h,d,l,c,u={},p=getComputedStyle(a),g=0;function f(e,s=25){return t.snapToGrid?Math.round(e/s)*s:e}function y(t){t.stopPropagation(),t.preventDefault(),r.releasePointerCapture(t.pointerId),r.ownerDocument.removeEventListener("pointermove",v),r.ownerDocument.removeEventListener("pointerup",y),r.style.cursor="inherit",o()}function v(e){if(e.stopPropagation(),e.preventDefault(),e.isTrusted&&(l=e.pageX,c=e.pageY),g=Math.max(g,Math.abs(h-l)),g=Math.max(g,Math.abs(d-c)),g<2)return;r.style.cursor="move";const i=t&&t.getScale?t.getScale():1,o=1/i*(l-h),p=1/i*(c-d);let y=f(u.left+o),v=f(u.top+p);if(s){const t=parseInt(m.toPx("4em"));y=Math.min(window.innerWidth-u.width/2,y),v=Math.min(window.innerHeight-t,v),y=Math.max(-u.width/2,y),v=Math.max(0,v)}a.style.left=`${y}px`,a.style.top=`${v}px`,n(o,p)}r.addEventListener("pointerdown",(function(t){0===t.button&&(t.stopPropagation(),t.preventDefault(),r.focus(),r.setPointerCapture(t.pointerId),g=0,h=t.pageX,d=t.pageY,l=t.pageX,c=t.pageY,p=getComputedStyle(a),u.left=parseFloat(p.left),u.top=parseFloat(p.top),u.width=parseFloat(p.width),u.height=parseFloat(p.height),r.ownerDocument.addEventListener("pointermove",v),r.ownerDocument.addEventListener("pointerup",y),document.dispatchEvent(new Event("closemenu")),i())}))}static makeResizeable(t,e=t,s=[],i=(()=>{}),n=(()=>{}),o=(()=>{})){if(!t||!t.isElement)return console.warning("Resizeable.enable: ResizeElement not defined");if(!e||!e.isElement)return console.warning("Resizeable.enable: AddToElement not defined");t.addClass("suey-resizeable");const r={};for(let h in d){const l=d[h],c=`suey-resizer-${l}`,u=new ft;let m,p,g,f;function y(e){0===e.button&&(e.stopPropagation(),e.preventDefault(),u.dom.setPointerCapture(e.pointerId),m=e.pageX,p=e.pageY,g=e.pageX,f=e.pageY,t.dom.ownerDocument.addEventListener("pointermove",b),t.dom.ownerDocument.addEventListener("pointerup",v),document.dispatchEvent(new Event("closemenu")),i())}function v(e){e.stopPropagation(),e.preventDefault(),u.dom.releasePointerCapture(e.pointerId),t.dom.ownerDocument.removeEventListener("pointermove",b),t.dom.ownerDocument.removeEventListener("pointerup",v),o()}function b(t){t.stopPropagation(),t.preventDefault(),t.isTrusted&&(g=t.pageX,f=t.pageY);n(u,g-m,f-p)}u.addClass("suey-resizer"),u.addClass(c),u.dom.addEventListener("pointerdown",y),r[l]=u,e.addToSelf(u)}const a={};t.toggleResize=function(e,s=!0){if(e)return a[e]=s,i(r[e],s),i(r[d.TOP_LEFT],a[d.TOP]&&a[d.LEFT]),i(r[d.TOP_RIGHT],a[d.TOP]&&a[d.RIGHT]),i(r[d.BOTTOM_LEFT],a[d.BOTTOM]&&a[d.LEFT]),i(r[d.BOTTOM_RIGHT],a[d.BOTTOM]&&a[d.RIGHT]),t;function i(t,e){t&&t.setStyle("display",e?"":"none")}};for(let w in d){const x=d[w];t.toggleResize(x,s.includes(x))}}}class St{static isChildOf(t,e){t.isElement&&t.dom&&(t=t.dom);let s=t.parentElement;for(;s;){if(s.isSameNode(e))return!0;s=s.parentElement}return!1}static isChildOfElementWithClass(t,e){t.isElement&&t.dom&&(t=t.dom);let s=t.parentElement;for(;s;){if(s.classList.contains(e))return!0;s=s.parentElement}return!1}static parentElementWithClass(t,e){t.isElement&&t.dom&&(t=t.dom);let s=t.parentElement;for(;s;){if(s.classList.contains(e))return s;s=s.parentElement}}static traverse(t,e=(()=>{}),s=!0){t.isElement&&t.dom&&(t=t.dom),s&&e(t);for(let s=0;s<t.children.length;s++)St.traverse(t.children[s],e,!0)}static parentScroller(t){return t?(t.isElement&&t.dom&&(t=t.dom),t.scrollHeight>t.clientHeight?t:St.parentScroller(t.parentElement)):null}static scrollIntoView(t){const e=St.parentScroller(t);if(e){const s=parseInt(m.toPx("0.2em"));t.offsetTop-e.offsetTop-s<e.scrollTop?e.scrollTop=t.offsetTop-e.offsetTop-s:t.offsetTop>e.scrollTop+e.clientHeight+s-e.offsetTop&&(e.scrollTop=t.offsetTop-e.clientHeight+t.offsetHeight+s-e.offsetTop)}}}const Tt=1,Lt=2;let It;const kt=new class{constructor(){const t=(new ft).setClass("suey-tooltip");t.setInnerHtml(""),document.body.appendChild(t.dom);let e=Tt;function s(e){if(e){const t=e.target;if(!(t&&t instanceof HTMLElement))return;if(!t.getAttribute("tooltip"))return}clearTimeout(It),t.removeClass("suey-updated")}document.addEventListener("touchstart",(()=>e=Lt),{capture:!0,passive:!0}),document.addEventListener("mousemove",(()=>e=Tt),{capture:!0,passive:!0}),document.addEventListener("mouseenter",(function(s){const i=s.target;if(!(i&&i instanceof HTMLElement))return;if(!i.getAttribute("tooltip"))return;if(s instanceof FocusEvent&&e!==Tt)return;if("TouchEvent"in window&&s instanceof TouchEvent)return;let n=i.getAttribute("tooltip");if(!n.length)return;clearTimeout(It),t.removeClass("suey-updated"),It=setTimeout((()=>{t.setInnerHtml(n),y.popUnder(t.dom,i,p.CENTER,null,o),t.addClass("suey-updated")}),parseInt(m.getVariable("--tooltip-delay")))}),{capture:!0,passive:!0}),document.addEventListener("mouseleave",s,{capture:!0,passive:!0}),document.addEventListener("dragleave",s,{capture:!0,passive:!0}),document.addEventListener("blur",s,{capture:!0,passive:!0}),document.addEventListener("hidetooltip",(()=>{s()}),{capture:!0,passive:!0})}};class Rt extends lt{constructor(){super(document.createElement("br"))}}class Mt extends lt{constructor(t=300,e=150){const s=document.createElementNS("http://www.w3.org/1999/xhtml","canvas");s.width=t,s.height=e,super(s),this.ctx=this.dom.getContext("2d")}get width(){return this.dom.width}set width(t){this.dom.width=t}get height(){return this.dom.height}set height(t){this.dom.height=t}ratio(){const t=this.dom.getBoundingClientRect();return this.dom.width/this.dom.height/(t.width/t.height)}}class Dt extends lt{constructor(t){super(document.createElement("span")),this.setInnerHtml(t)}}class Ht extends Dt{constructor(t){super(t),this.setClass("suey-text"),this.setStyle("cursor","default")}}class At extends ft{constructor(){super(),this.addClass("suey-row")}}const Nt={TABS:"tabs",NORMAL:"normal"};class Pt extends ft{constructor(t="50%",e=Nt.TABS){super(),this.addClass("suey-property-list"),this.setStyle("display","block"),this.leftPropertyWidth=t,this.leftPropertySpacing=e}setLeftPropertyWidth(t="50%"){return this.leftPropertyWidth=t,this}#s(){let t=this.leftPropertyWidth??"50%";return"string"==typeof this.leftPropertyWidth?t=parseInt(this.leftPropertyWidth):"number"==typeof this.leftPropertyWidth&&(t=100*parseFloat(this.leftPropertyWidth)),!Number.isNaN(t)&&Number.isFinite(t)||(t=50),t=Math.max(t,0),t=Math.min(t,100),t}#i(){return`${this.#s()}%`}#n(){return 100-this.#s()+"%"}addHeader(t="",e){const s=this.createHeader(t,e);return this.add(s),s}addRow(t="",...e){const s=this.createRow(t,...e);return this.add(s),s}addRowWithoutTitle(...t){const e=this.createRowWithoutTitle(...t);return this.add(e),e}createHeader(t="",e){const s=(new ft).setClass("suey-property-header-title"),i=new vt(e),n=(new Dt).setClass("suey-property-header-icon").add(i),o=(new Dt).setClass("suey-property-header-text").setTextContent(t);return s.add(n,o),s}createRow(t="",...e){const s=this.createControls(...e),i=new Ht(t).selectable(!1).addClass("suey-property-left");this.leftPropertySpacing===Nt.TABS&&i.addClass("suey-left-tab-spacing"),m.setVariable("--left-property-width",this.#i(),i),m.setVariable("--right-property-width",this.#n(),s);const n=(new At).addClass("suey-property-row").add(i,s);return n.leftWidget=i,n.rightWidget=s,n}createRowWithoutTitle(...t){const e=this.createControls(...t);e.removeClass("suey-property-right").addClass("suey-property-full");const s=(new At).addClass("suey-property-row").add(e);return s.leftWidget=e,s.rightWidget=e,s}createControls(){const t=(new At).setStyle("margin","0","padding","0").addClass("suey-property-right");let e=arguments;1===arguments.length&&Array.isArray(arguments[0])&&(e=arguments[0]);for(let s=0;s<e.length;s++){const i=e[s];i instanceof lt&&i.isElement?(t.add(i),s<e.length-1&&t.add((new Dt).addClass("suey-property-space"))):console.error("PropertyList.createControls():",i,"is not an instance of Element.")}return t}disableInputs(t=!0){const e=["suey-button","suey-checkbox","suey-checkbox-input","suey-number","suey-slider","suey-tick-marks","suey-text-area","suey-text-box"];for(let s=0;s<e.length;s++){const i=this.dom.getElementsByClassName(e[s]);for(let e=0;e<i.length;e++)t?(i[e].classList.add("suey-disabled"),i[e].disabled=!0):(i[e].classList.remove("suey-disabled"),i[e].disabled=!1)}}}class Ot extends ft{#o=0;#r=[];#a=null;constructor(t=!1){super();const e=this;this.setClass("suey-tree-list"),this.allowFocus(),this.multiSelect=t,this.options=[],this.selectedValue=null,this.selectedValues=[],this.onKeyDown((function(t){if(e.multiSelect){if(t.shiftKey||(e.#o=0,e.#r=[]),"ArrowUp"===t.key||"ArrowDown"===t.key){t.preventDefault(),t.stopPropagation();let s=[...e.selectedValues];if(t.shiftKey){0===e.#r.length&&(e.#r=[...s]),s=[...e.#r];let i=s[s.length-1],n=e.getIndex(i);if(-1===n)return;if("ArrowUp"===t.key&&n+e.#o>0&&e.#o--,"ArrowDown"===t.key&&n+e.#o<e.options.length-1&&e.#o++,n+=e.#o,n<0||n>e.options.length-1)return;const o=e.getIndex(s[s.length-1]),r=n;if(o<r)for(let t=o;t<=r;t++){const i=e.options[t].value;s.includes(i)||s.push(i)}else for(let t=o;t>=r;t--){const i=e.options[t].value;s.includes(i)||s.push(i)}e.setValues(s,!0),e.dom.dispatchEvent(new Event("change"))}else if(s.length>0){let i=s[s.length-1],n=e.getIndex(i);if(-1===n)return;"ArrowUp"===t.key&&n--,"ArrowDown"===t.key&&n++,n>=0&&n<e.options.length&&(e.setValues([e.options[n].value],!0),e.dom.dispatchEvent(new Event("change")))}}}else if("ArrowUp"===t.key||"ArrowDown"===t.key){t.preventDefault(),t.stopPropagation();let s=e.getIndex(e.selectedValue);if(-1===s)return;"ArrowUp"===t.key&&s--,"ArrowDown"===t.key&&s++,s>=0&&s<e.options.length&&(e.setValue(e.options[s].value,!0),e.dom.dispatchEvent(new Event("change")))}})),this.onKeyUp((function(t){switch(t.key){case"ArrowUp":case"ArrowDown":t.preventDefault(),t.stopPropagation(),t.shiftKey||(e.#o=0,e.#r=[])}}))}getIndex(t){for(let e=0;e<this.options.length;e++)if(this.options[e].value==t)return e;return-1}getOption(t){for(let e=0;e<this.options.length;e++)if(this.options[e].value==t)return this.options[e]}getValue(){return this.selectedValue}setValue(t,e=!1){let s;for(let t=0;t<this.options.length;t++)this.options[t].classList.remove("suey-active");for(let e=0;e<this.options.length;e++){const i=this.options[e];i.value==t&&(i.classList.add("suey-active"),s=i)}return s&&e&&setTimeout((()=>St.scrollIntoView(s)),0),this.selectedValue=t,this}getValues(){return this.selectedValues}setValues(t=[],e=!1){let s;for(const t of this.options)t.classList.remove("suey-active"),t.classList.remove("suey-active-top"),t.classList.remove("suey-active-bottom");for(const e of t)for(const t of this.options)t.value==e&&(t.classList.add("suey-active"),s=t);for(let t=0;t<this.options.length-1;t++){const e=this.options[t],s=this.options[t+1];e.classList.contains("suey-active")&&s.classList.contains("suey-active")&&(e.classList.add("suey-active-top"),s.classList.add("suey-active-bottom"))}return s&&e&&setTimeout((()=>{St.scrollIntoView(s)}),0),this.selectedValues=[...t],this}setOptions(t){const e=this;function s(t){if(t.shiftKey||(e.#o=0,e.#r=[]),e.multiSelect){let s=!1;if(s=s||!this.singleSelect,s=s||e.selectedValues.length<1,1===e.selectedValues.length){const t=e.getOption(e.selectedValues[0]);t&&!0===t.singleSelect&&(s=!1)}let i=[...e.selectedValues];if(t.altKey||t.ctrlKey||t.metaKey){if(i.includes(this.value)){const t=i.indexOf(this.value);i.splice(t,1)}else s&&i.push(this.value);e.setValues(i)}else if(t.shiftKey&&i.length>0){if(s){0===e.#r.length&&(e.#r=[...e.selectedValues]),i=[...e.#r];const t=e.getIndex(i[i.length-1]),s=e.getIndex(this.value);if(t<s)for(let n=t;n<=s;n++){if(e.options[n].singleSelect)continue;const t=e.options[n].value;i.includes(t)||i.push(t)}else for(let n=t;n>=s;n--){if(e.options[n].singleSelect)continue;const t=e.options[n].value;i.includes(t)||i.push(t)}e.#o=s-t,e.setValues(i)}}else i.includes(this.value)||e.setValues([this.value])}else e.setValue(this.value);this.addEventListener("pointerup",i),e.dom.dispatchEvent(new Event("change"))}function i(t){e.multiSelect&&(t.altKey||t.ctrlKey||t.metaKey||t.shiftKey||e.setValues([this.value])),this.removeEventListener("pointerup",i)}let n;function o(){n=this}function r(t){if(e.multiSelect){const s=this.getBoundingClientRect(),i=s.width,n=s.height*e.selectedValues.length;e.#a=document.createElement("div"),e.#a.classList.add("suey-tree-list"),e.#a.classList.add("suey-drag-image"),e.#a.style.width=`${i}px`,e.#a.style.height=`${n}px`,e.#a.style.top=-2*n+"px";for(let t=0;t<e.selectedValues.length;t++){const s=e.selectedValues[t],i=e.getOption(s).cloneNode(!0);i.classList.add("suey-active-top"),i.classList.add("suey-active-bottom"),e.#a.appendChild(i)}document.body.appendChild(e.#a),t.dataTransfer.setDragImage(e.#a,0,0),t.dataTransfer.setData("text/plain",e.selectedValues)}else t.dataTransfer.setData("text/plain",e.selectedValue)}function a(t){e.#a instanceof HTMLElement&&(document.body.removeChild(e.#a),e.#a=null)}function h(t){if(!n||this===n)return;const e=t.offsetY/this.clientHeight;this.dropGroup!==n.dropGroup?(this.classList.remove("suey-drag"),this.classList.remove("suey-drag-top"),this.classList.remove("suey-drag-bottom")):this.noDirectDrop?(this.classList.remove("suey-drag"),e<.5?(this.classList.add("suey-drag-top"),this.classList.remove("suey-drag-bottom")):(this.classList.add("suey-drag-bottom"),this.classList.remove("suey-drag-top"))):e<.25?(this.classList.add("suey-drag-top"),this.classList.remove("suey-drag"),this.classList.remove("suey-drag-bottom")):e<.75?(this.classList.add("suey-drag"),this.classList.remove("suey-drag-top"),this.classList.remove("suey-drag-bottom")):(this.classList.add("suey-drag-bottom"),this.classList.remove("suey-drag"),this.classList.remove("suey-drag-top"))}function d(){n&&this!==n&&(this.classList.remove("suey-drag"),this.classList.remove("suey-drag-top"),this.classList.remove("suey-drag-bottom"))}function l(t){if(t.preventDefault(),t.stopPropagation(),this.classList.remove("suey-drag"),this.classList.remove("suey-drag-top"),this.classList.remove("suey-drag-bottom"),n&&this!==n&&this.dropGroup===n.dropGroup){const s=t.dataTransfer.getData("text/plain").split(",");"function"==typeof e.onDrop&&e.onDrop(t,this,s)}n=void 0}this.clearContents(),e.options=[];for(let i=0;i<t.length;i++){const n=t[i];n.classList.add("suey-option"),e.dom.appendChild(n),e.options.push(n),n.addEventListener("pointerdown",s),n.addEventListener("destroy",(()=>n.removeEventListener("pointerdown",s)),{once:!0}),n.draggable&&(n.addEventListener("drag",o),n.addEventListener("dragstart",r),n.addEventListener("dragend",a),n.addEventListener("dragover",h),n.addEventListener("dragleave",d),n.addEventListener("drop",l),n.addEventListener("destroy",(()=>{n.removeEventListener("drag",o),n.removeEventListener("dragstart",r),n.removeEventListener("dragend",a),n.removeEventListener("dragover",h),n.removeEventListener("dragleave",d),n.removeEventListener("drop",l)}),{once:!0}))}return this}}class Ft extends lt{constructor(t){super(document.createElement("label")),this.setClass("suey-checkbox"),this.checkbox=new lt(document.createElement("input")),this.checkbox.setClass("suey-input"),this.checkbox.addClass("suey-checkbox-input"),this.checkbox.dom.type="checkbox",this.button=(new ft).addClass("suey-checkbox-button"),this.add(this.checkbox,this.button),this.setValue(t)}getValue(){if(this.checkbox.dom)return this.checkbox.dom.checked}setValue(t){return this.checkbox.dom?(this.checkbox.dom.checked=!!Boolean(t),this):this}}const Bt=new v;class $t extends gt{constructor(){super();const t=this;this.addClass("suey-color-button"),this.addClass("suey-drop-arrow");const e=new lt(document.createElement("input"));e.setClass("suey-input"),e.addClass("suey-color-input-button"),e.dom.setAttribute("autocomplete","off");try{e.dom.type="color"}catch(t){}this.add(e);const s=(new ft).addClass("suey-drop-color");s.setStyle("backgroundColor",e.dom.value),this.add(s);let i=!1;function n(){t.removeClass("suey-selected"),i=!1}e.onClick((function(s){i?(s.stopPropagation(),s.preventDefault(),e.blur()):(t.addClass("suey-selected"),i=!0)})),e.onInput((function(){s.setStyle("backgroundColor",e.dom.value),t.dom.setAttribute("tooltip",e.dom.value)})),e.dom.addEventListener("blur",n),e.dom.addEventListener("focusout",n),this.getValue=function(){return e.dom?e.dom.value:0},this.getHexValue=function(){return e.dom?(Bt.set(e.dom.value),Bt.hex()):0},this.setValue=function(i){return e.dom?(Bt.set(i),e.dom.value=Bt.hexString(),s.setStyle("backgroundColor",e.dom.value),t.dom.setAttribute("tooltip",e.dom.value),this):this},this.setValue(16777215)}}class Gt extends ft{constructor(){super(),this.setClass("suey-menu-separator")}}const Vt=new v;class zt extends ft{#h=!1;constructor(){super(),this.setClass("suey-menu"),this.mouseSvg=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.mouseSvg.setAttribute("class","suey-menu-mouse-triangle"),this.mouseSvg.setAttribute("pointer-events","none"),this.mouseSvg.setAttribute("version","1.1"),this.mouseArea=document.createElementNS("http://www.w3.org/2000/svg","polygon"),this.mouseArea.setAttribute("fill",Vt.setRandom().hexString()),this.mouseArea.setAttribute("opacity","0.0"),this.mouseArea.setAttribute("pointer-events","fill"),this.mouseSvg.appendChild(this.mouseArea),this.menuParentDom=void 0}add(){if(!this.#h&&this.children){let t=this.children;if(t.length>0){"MenuSeparator"!==t[t.length-1].constructor.name&&super.add(new Gt)}}return arguments&&arguments.length>0&&(this.#h=!0,super.add(...arguments)),this}newCategory(){this.#h=!1}closeMenu(t=!0,e=void 0){if(this.traverse((t=>{e&&St.isChildOf(t.dom,e)||(t.removeClass("suey-menu-show","suey-selected"),t.attachedMenu&&"function"==typeof t.attachedMenu.closeMenu&&t.attachedMenu.closeMenu(!0),t.dom&&"function"==typeof t.dom.blur&&t.dom.blur())}),t),t){let t=this.menuParentDom;for(;t;)this.menuParentDom.classList.contains("suey-menu-button")?(t.classList.remove("suey-selected"),t=void 0):t=t.parentElement;"function"==typeof this.removeHandlers&&this.removeHandlers(),document.dispatchEvent(new Event("nofocus"))}}isShown(){return this.hasClass("suey-menu-show")}showMenu(t){const e=this;if(this.menuParentDom=t,this.addClass("suey-menu-show"),this.focus(),St.isChildOfElementWithClass(this.dom,"suey-menu")){this.mouseArea.setAttribute("pointer-events","none"),this.contents().dom.insertBefore(this.mouseSvg,this.contents().dom.firstChild),this.updateMouseArea();const t=1e3*parseFloat(m.getVariable("--menu-timing"));setTimeout((()=>this.updateMouseArea()),t)}function s(){e.closeMenu()}function i(t){"Escape"===t.key&&e.closeMenu()}function n(t){e.dom.contains(t.target)||e.closeMenu()}return document.addEventListener("closemenu",s),document.addEventListener("keydown",i),document.addEventListener("pointerdown",n),this.removeHandlers=function(){document.removeEventListener("closemenu",s),document.removeEventListener("keydown",i),document.removeEventListener("pointerdown",n)},this.dom.addEventListener("destroy",(function(){e.removeHandlers()}),{once:!0}),this}updateMouseArea(){const t=this.dom.parentElement.getBoundingClientRect(),e=this.dom.getBoundingClientRect();if(this.hasClass("suey-menu-under")){const s=e.width/2,i=s-t.width/2,n=s+t.width/2,o=t.height/1.5;this.mouseSvg.style.left="0",this.mouseSvg.style.top=`-${o}px`,this.mouseSvg.setAttribute("width",`${e.width}px`),this.mouseSvg.setAttribute("height",`${e.height+o}px`);const r=`${i},0`,a=`0,${o}`,h=`0,${e.height+o}`,d=`${e.width},${e.height+o}`,l=`${e.width},${o}`,c=`${n},0`;this.mouseArea.setAttributeNS(null,"points",`${r} ${a} ${h} ${d} ${l} ${c}`),this.mouseArea.setAttribute("pointer-events","fill")}else{const s=t.top-e.top+t.height/2,i=s-t.height/2,n=s+t.height/2,o=t.width/3,r=10;this.mouseSvg.style.left=`-${o}px`,this.mouseSvg.style.top=`-${r}px`,this.mouseSvg.setAttribute("width",`${e.width+o}px`),this.mouseSvg.setAttribute("height",`${e.height+2*r}px`);const a=`${o},0`,h=`0,${r+i}`,d=`0,${r+n}`,l=`${o},${e.height+2*r}`,c=`${o+e.width},${e.height+2*r}`,u=`${o+e.width},0`;this.mouseArea.setAttributeNS(null,"points",`${a} ${h} ${d} ${l} ${c} ${u}`),this.mouseArea.setAttribute("pointer-events","fill")}return this}}class Wt extends ft{constructor(t=void 0){super(),this.setClass("suey-menu-shortcut"),t&&this.setShortcutText(t)}setShortcutText(t){if(!t)return this;this.text=t,this.clearContents();for(let e=0;e<t.length;e++){let s=(new ft).setClass("suey-menu-shortcut-character"),i=t[e];for(;e+1<t.length&&t[e+1]===t[e+1].toLowerCase();)i+=t[e+1],e++;1===i.length?s.setWidth("1em"):(s.setStyle("paddingLeft","0.15em"),s.setStyle("paddingRight","0.15em")),s.dom.textContent=i,this.add(s)}return this}}class Ut extends ft{constructor(t=void 0,e=void 0,s=void 0){super();const i=this;function n(t){t.preventDefault()}function o(t=void 0){let e=i.parent;for(;e&&!1===e.hasClass("suey-menu");)e=e.parent;e&&"function"==typeof e.closeMenu&&e.closeMenu(!1,t)}function r(){let t=i.parent;for(;t&&!1===t.hasClass("suey-menu");)t=t.parent;if(!t.hasClass("suey-invisible-menu")){const t=new Event("hidetooltip",{bubbles:!0});i.dom.dispatchEvent(t)}o(i.dom),i.subMenu&&i.subMenu.showMenu(i.dom)}function a(){o()}this.setClass("suey-menu-item"),this.setName(t),this.divIcon=new vt(e),this.divIconHolder=(new ft).add(this.divIcon).setClass("suey-menu-icon"),this.divText=(new ft).setClass("suey-menu-text"),this.divSpacer=(new ft).setStyle("flex","1 1 auto"),this.divShortcut=new Wt(s),this.row=(new At).add(this.divIconHolder,this.divText,this.divSpacer,this.divShortcut),this.add(this.row),this.checked=!1,this.disabled=!1,this.subMenu=void 0;let h=!1;function d(t){t.stopPropagation(),t.preventDefault(),i.dom.dispatchEvent(new Event("select")),h=!0}function l(t){t.stopPropagation(),t.preventDefault(),!0!==h&&i.dom.dispatchEvent(new Event("select")),h=!1}this.dom.addEventListener("contextmenu",n),this.dom.addEventListener("pointerenter",r),this.dom.addEventListener("pointerleave",a),this.dom.addEventListener("pointerdown",d),this.dom.addEventListener("pointerup",l),this.dom.addEventListener("destroy",(()=>{i.dom.removeEventListener("contextmenu",n),i.dom.removeEventListener("pointerenter",r),i.dom.removeEventListener("pointerleave",a),i.dom.removeEventListener("pointerdown",d),i.dom.removeEventListener("pointerup",l)}),{once:!0}),this.setText(t),this.selectable(!1)}onPointerDown(t){return console.trace(`MenuItem.onPointerDown() deprecated, use onSelect() instead, from: ${this.getName()}`),this.onSelect(t),this}onPointerUp(t){return console.trace(`MenuItem.onPointerUp() deprecated, use onSelect() instead, from: ${this.getName()}`),this.onSelect(t),this}onClick(t){return console.trace(`MenuItem.onClick() deprecated, use onSelect() instead, from: ${this.getName()}`),this.onSelect(t),this}onDblClick(t){return console.trace(`MenuItem.onDblClick() deprecated, use onSelect() instead, from: ${this.getName()}`),this.onSelect(t),this}onSelect(t){if("function"!=typeof t)return;const e=this;t=t.bind(e);const s=function(s){s.preventDefault(),s.stopPropagation(),e.hasClass("suey-disabled")||(t(s),e.hasClass("suey-keep-open")||document.dispatchEvent(new Event("closemenu")))},i=e.dom;return i.addEventListener("select",s),i.addEventListener("destroy",(()=>{i.removeEventListener("select",s)}),{once:!0}),e}isChecked(){return this.checked}isDisabled(){return this.disabled}keepOpen(){return this.addClass("suey-keep-open"),this}setChecked(e){const i=e?t:s;return e?this.divIcon.addClass("suey-icon-colorize"):this.divIcon.removeClass("suey-icon-colorize"),this.setImage(i),this.checked=e,this}setDisabled(t){return t?this.addClass("suey-disabled"):this.removeClass("suey-disabled"),this.disabled=t,this}setImage(t){return this.divIcon.setImage(t),this}setText(t){return this.divText.dom.textContent=t??" ",this}attachSubMenu(t){return!1===t.hasClass("suey-menu")||(t.addClass("suey-slide-down"),this.removeSubMenu(),this.addClass("suey-sub-menu-item"),this.add(t),this.subMenu=t),this}hasSubMenu(){return this.hasClass("suey-sub-menu-item")}removeSubMenu(){this.removeClass("suey-sub-menu-item");const t=this.subMenu;this.subMenu=void 0;for(let t=this.contents().dom.children.length-1;t>=0;t--){let e=this.contents().dom.children[t];e.classList.contains("suey-menu")&&this.remove(e)}return t}}class _t extends gt{constructor(t){super(t);const e=this;this.items=[],this.currentIndex=-1,this.value=void 0,this.menuOffsetX=0,this.menuOffsetY=5,this.addClass("suey-dropdown"),this.addClass("suey-drop-arrow"),this.onWheel((function(t){t.stopPropagation(),t.preventDefault(),t.deltaY<0?e.currentIndex>0&&(e.setIndex(e.currentIndex-1),e.dom&&e.dom.dispatchEvent(new Event("change"))):e.currentIndex<e.items.length-1&&(e.setIndex(e.currentIndex+1),e.dom&&e.dom.dispatchEvent(new Event("change")))}))}getItemByKey(t){for(let e=0;e<this.items.length;e++)if(this.items[e].value===t)return this.items[e]}getIndex(){return this.currentIndex}getValue(){return this.value}setIndex(t=0){if(t<0||t>=this.items.length||t===this.currentIndex)return;const e=this.items[t];for(let t=0;t<this.items.length;t++)this.items[t].setChecked(!1);return e.setChecked(!0),this.currentIndex=t,this.value=e.value,this.dom&&(this.dom.textContent=e.dom.textContent),this}setValue(t){if(t=String(t),this.value!==t)for(let e=0;e<this.items.length;e++){const s=this.items[e];if(s.value===t){for(let t=0;t<this.items.length;t++)this.items[t].setChecked(!1);return s.setChecked(!0),this.currentIndex=e,this.value=t,this.dom&&(this.dom.textContent=s.dom.textContent),this}}return this}setOptions(t){const e=this;this.detachMenu&&this.detachMenu(),this.items.length=0;for(const s in t){const i=new Ut(t[s]);i.value=s,i.onSelect((()=>{e.setValue(i.value),e.dom&&e.dom.dispatchEvent(new Event("change"))})),this.items.push(i)}const s=new zt;for(let t=0;t<this.items.length;t++)s.add(this.items[t]);return this.attachMenu(s),s.addClass("suey-select-menu"),this}}const Kt=new Event("change",{bubbles:!0,cancelable:!0});class Yt extends lt{constructor(t){super(document.createElement("input"));const e=this;function s(t){e.dom&&e.setValue(e.dom.value)}function i(t){if(t.stopPropagation(),"z"===t.key&&(t.ctrlKey||t.metaKey))return t.preventDefault(),void(t.shiftKey?editor.redo():editor.undo());switch(t.key){case"Enter":e.dom&&(e.dom.style.cursor="text"),e.dom&&e.dom.blur();break;case"ArrowUp":t.preventDefault(),e.setValue(e.getValue()+e.nudge),e.dom&&e.dom.dispatchEvent(Kt);break;case"ArrowDown":t.preventDefault(),e.setValue(e.getValue()-e.nudge),e.dom&&e.dom.dispatchEvent(Kt)}}function n(t){t.stopPropagation()}function o(t){t.preventDefault();const s=t.deltaY<0?-1:1,i=e.getValue()-s*e.step;e.setValue(i),e.dom&&e.dom.dispatchEvent(Kt)}this.setClass("suey-input"),this.addClass("suey-number"),this.dom.style.cursor="text",this.dom.value="0.00",this.dom.setAttribute("autocomplete","off"),this.value=0,this.min=-1/0,this.max=1/0,this.precision=3,this.step=.1,this.unit="",this.nudge=1,this.setValue(t),this.dom.addEventListener("keydown",i),this.dom.addEventListener("keyup",n),this.dom.addEventListener("wheel",o),this.dom.addEventListener("change",s),this.dom.addEventListener("destroy",(function(){e.dom.removeEventListener("keydown",i),e.dom.removeEventListener("keyup",n),e.dom.removeEventListener("wheel",o),e.dom.removeEventListener("change",s)}),{once:!0})}getValue(){return parseFloat(this.value)}setValue(t){let e=parseFloat(t);if(void 0===e||isNaN(e)||!isFinite(e))return this;e<this.min&&(e=this.min),e>this.max&&(e=this.max),e=parseFloat(e.toFixed(this.precision));let s=Math.min(this.precision,(i=e,Math.floor(i.valueOf())===i.valueOf()?0:i.toString().split(".")[1].length||0));var i;return e=e.toFixed(s),void 0!==e&&!isNaN(e)&&isFinite(e)&&(this.value=e,this.dom&&(this.dom.value=e),this.dom&&""!==this.unit&&(this.dom.value=e+" "+this.unit)),this}setPrecision(t){return this.precision=parseFloat(t),this}setStep(t){return this.step=parseFloat(t),this}setNudge(t){return this.nudge=parseFloat(t),this}setMin(t){return this.min=parseFloat(t),this}setMax(t){return this.max=parseFloat(t),this}setRange(t,e){return this.setMin(t),this.setMax(e),this}setUnit(t){return this.unit=t,this}}class Xt extends Yt{constructor(t){super(t);const e=this;this.addClass("suey-number-scroll"),this.dom.style.cursor="ns-resize";let s=0,i=0;const n={x:0,y:0},o={x:0,y:0};function r(t){t.preventDefault(),s=0,i=e.getValue(),o.x=t.clientX,o.y=t.clientY}function a(t){const r=e.getValue();let a;n.x=t.clientX,n.y=t.clientY,s+=n.x-o.x-(n.y-o.y),a=i+s/(t.shiftKey?.1:1)*e.step,a=Math.min(e.max,Math.max(e.min,a)),r!==a&&(e.setValue(a),e.dom&&e.dom.dispatchEvent(Kt)),o.x=t.clientX,o.y=t.clientY}function h(){Math.abs(s)<2&&e.dom&&e.dom.focus()}function d(t){1===t.touches.length&&(s=0,i=e.getValue(),o.x=t.touches[0].pageX,o.y=t.touches[0].pageY)}function l(t){const r=e.getValue();let a;n.x=t.touches[0].pageX,n.y=t.touches[0].pageY,s+=n.x-o.x-(n.y-o.y),a=i+s/(t.shiftKey?5:50)*e.step,a=Math.min(e.max,Math.max(e.min,a)),r!==a&&(e.setValue(a),e.dom&&e.dom.dispatchEvent(Kt)),o.x=t.touches[0].pageX,o.y=t.touches[0].pageY}function c(t){0===t.touches.length&&Math.abs(s)<2&&e.dom&&e.dom.focus()}function u(){e.dom&&(e.dom.style.cursor="")}function m(){e.dom&&(e.dom.style.cursor="ns-resize")}this.dom.addEventListener("mousedown",r),this.dom.addEventListener("mousemove",a),this.dom.addEventListener("mouseup",h),this.dom.addEventListener("touchstart",d),this.dom.addEventListener("touchmove",l),this.dom.addEventListener("touchend",c),this.dom.addEventListener("focus",u),this.dom.addEventListener("blur",m),this.dom.addEventListener("destroy",(function(){e.dom.removeEventListener("mousedown",r),e.dom.removeEventListener("mousemove",a),e.dom.removeEventListener("mouseup",h),e.dom.removeEventListener("touchstart",d),e.dom.removeEventListener("touchmove",l),e.dom.removeEventListener("touchend",c),e.dom.removeEventListener("focus",u),e.dom.removeEventListener("blur",m)}),{once:!0})}}const qt=new Event("change",{bubbles:!0,cancelable:!0});class Zt extends ft{constructor(t=0,e=0,s=100){super();const i=this;this.setClass("suey-slide-container"),this.precision=2;const n=new lt(document.createElement("input"));n.setClass("suey-input"),n.addClass("suey-slider"),n.dom.type="range",n.dom.value=t,n.dom.min=e,n.dom.max=s;const o=new ft(" ").addClass("suey-tick-marks");this.slider=n,this.ticks=o,this.add(o,n),n.onInput((function(){if(!n.dom)return;const t=parseFloat(n.dom.value),e=parseFloat(n.dom.min),s=parseFloat(n.dom.max);n.dom.style.setProperty("--middle",""+(t-e)/(s-e))})),n.onWheel((function(t){if(!n.dom)return;t.preventDefault();const e=t.deltaY<0?-1:1,s=parseFloat(n.dom.min),o=parseFloat(n.dom.max);let r=n.dom.step;r="any"===r?Number.isFinite(o)&&Number.isFinite(s)?(o-s)/20:1:parseFloat(r);const a=i.getValue()-e*r;i.setValue(a),n.dom.dispatchEvent(qt)}))}getValue(){return this.slider.dom?parseFloat(this.slider.dom.value):null}setValue(t){if(!this.slider.dom)return this;let e=parseFloat(t);if(void 0===e||isNaN(e)||!isFinite(e))return this;e<this.min&&(e=this.min),e>this.max&&(e=this.max),e=parseFloat(e.toFixed(this.precision));let s=Math.min(this.precision,(i=e,Math.floor(i.valueOf())===i.valueOf()?0:i.toString().split(".")[1].length||0));var i;e=e.toFixed(s),void 0!==e&&!isNaN(e)&&isFinite(e)&&(this.slider.dom.value=e);const n=parseFloat(this.slider.dom.value),o=parseFloat(this.slider.dom.min),r=parseFloat(this.slider.dom.max);return this.slider.dom.style.setProperty("--middle",""+(n-o)/(r-o)),this}setPrecision(t){return this.precision=t,this}setMin(t){return this.slider.dom?(this.slider.dom.min=t,this.setTicks(),this):this}setMax(t){return this.slider.dom?(this.slider.dom.max=t,this.setTicks(),this):this}setRange(t,e){return this.slider.dom?(this.slider.dom.min=t,this.slider.dom.max=e,this.setTicks(),this):this}setStep(t){return this.slider.dom?(this.slider.dom.step=t,this.setTicks(),this):this}setTicks(){if(!this.slider.dom)return this;const t=this.ticks,e=parseFloat(this.slider.dom.min),s=parseFloat(this.slider.dom.max),i=this.slider.dom.step;if("any"!==i&&Number.isFinite(e)&&Number.isFinite(s)){const n=parseFloat((s-e)/i),o=9;let r=n;if(r>o)for(let t=1;t<=o;t++)Number.isInteger(n/t)&&(r=t);t.dom.style.setProperty("--divides",`${r}`)}else t.setStyle("display","none")}}class jt extends lt{constructor(){super(document.createElement("textarea")),this.setClass("suey-text-area"),this.dom.spellcheck=!1,this.dom.setAttribute("autocomplete","off"),this.onKeyDown((function(t){if(t.stopPropagation(),"Tab"===t.key){t.preventDefault();const e=this.selectionStart;this.value=this.value.substring(0,e)+"\t"+this.value.substring(e),this.selectionStart=e+1,this.selectionEnd=this.selectionStart}}))}getValue(){return this.dom?this.dom.value:null}setValue(t){return this.dom?(this.dom.value=t,this):this}}class Jt extends lt{constructor(t){super(document.createElement("input")),this.setClass("suey-input"),this.addClass("suey-text-box"),this.dom.type="text",this.dom.setAttribute("autocomplete","off"),this.dom.setAttribute("spellcheck","false"),this.setValue(t??""),this.onKeyDown((function(t){t.stopPropagation(),"z"===t.key&&(t.ctrlKey||t.metaKey)&&(t.preventDefault(),t.shiftKey?editor.redo():editor.undo())})),this.onKeyUp((function(t){t.stopPropagation()}))}getValue(){return this.dom?this.dom.value:null}setValue(t){return this.dom?(this.dom.value=t,this):this}}class Qt extends ft{constructor(){super(),this.setClass("suey-absolute-box")}}class te extends ft{constructor(t="",e="icon",s=!0){super(),this.setClass("suey-asset-box"),this.allowFocus(),""!==t&&this.dom.setAttribute("tooltip",t),"string"==typeof t&&""!==t||(t="Unknown"),this.setName(t.toLowerCase());const i=new bt;if(i.dom.draggable=!0,"icon"==e)s&&(this.addClass("suey-asset-box-mini"),this.addClass("suey-asset-box-selectable")),this.add(i);else if("text"==e){s&&(this.addClass("suey-asset-box-mini"),this.addClass("suey-asset-box-combo"),this.addClass("suey-asset-box-selectable")),i.setStyle("transform","translate(-50%, -65%) scale(0.8)"),this.add(i);const e=new ft(t).setClass("suey-asset-box-label");this.add(e)}else{this.addClass("suey-asset-box-row"),this.addClass("suey-asset-box-selectable");const e=(new Dt).setClass("suey-asset-box-icon").add(i),s=new Dt(t).setClass("suey-asset-box-text");this.add(e,s),this.assetText=s}this.contents=function(){return i}}}const ee={NONE:"none",SIMPLE:"simple",FANCY:"fancy"};class se extends ft{constructor({style:t=ee.NONE}={}){if(super(),this.setClass("suey-panel"),this.contents=function(){return this},t===ee.SIMPLE)this.addClass("suey-panel-simple");else if(t===ee.FANCY){this.addClass("suey-panel-fancy");const t=(new se).setClass("suey-panel-fancy-outer"),e=(new se).setClass("suey-panel-fancy-border"),s=(new se).setClass("suey-panel-fancy-inside");e.add(s),t.add(e),this.add(t),this.contents=function(){return s}}this.onContextMenu((function(t){t.preventDefault()}))}}const ie={LEFT:"left",RIGHT:"right"};class ne extends se{#d=null;#l=null;#c=0;#u=1/0;#m=0;#p=1/0;constructor({tabSide:t=ie.RIGHT,style:e=ee.FANCY,resizers:s=[],startWidth:i=null,startHeight:n=null,minWidth:o=0,maxWidth:r=1/0,minHeight:a=0,maxHeight:h=1/0}={}){super({style:e});const d=this;this.addClass("suey-tabbed"),this.setName("suey-tabbed"),this.#d=i,this.#c=o,this.#u=r,this.#l=n,this.#m=a,this.#p=h,this.tabs=[],this.panels=[],this.selectedId="",this.selectedCount=0;const l={};Et.makeResizeable(this,this,s,(function(){l.width=d.getWidth(),l.height=d.getHeight(),d.dom.dispatchEvent(new Event("clicked",{bubbles:!0,cancelable:!0}))}),(function(t,e,s){t.hasClassWithString("left")&&d.changeWidth(l.width-e),t.hasClassWithString("right")&&d.changeWidth(l.width+e),t.hasClassWithString("top")&&d.changeHeight(l.height-s),t.hasClassWithString("bottom")&&d.changeHeight(l.height+s)})),this.tabsDiv=(new ft).setClass("suey-tabs").setDisplay("none"),this.panelsDiv=(new ft).setClass("suey-tab-panels"),this.add(this.tabsDiv),this.add(this.panelsDiv),this.setTabSide(t)}changeWidth(t){if("number"==typeof t&&!Number.isNaN(t)&&Number.isFinite(t)||(t=this.#d),null==t)return this.dom.style.removeProperty("width"),null;const e=this.#c*m.guiScale(this.dom),s=this.#u*m.guiScale(this.dom);return t=Math.min(s,Math.max(e,parseFloat(t))).toFixed(1),this.setStyle("width",m.toEm(t,this.dom)),this.dom.dispatchEvent(new Event("resized")),t}changeHeight(t){if("number"==typeof t&&!Number.isNaN(t)&&Number.isFinite(t)||(t=this.#l),null==t)return this.dom.style.removeProperty("height"),null;const e=this.#m*m.guiScale(this.dom),s=this.#p*m.guiScale(this.dom);return t=Math.min(s,Math.max(e,parseFloat(t))).toFixed(1),this.setStyle("height",m.toEm(t,this.dom)),this.dom.dispatchEvent(new Event("resized")),t}addTab(t,e,i={}){"object"!=typeof i&&(i={}),"color"in i&&null!=i.color||(i.color=rt.color(h.ICON)),"alpha"in i||(i.alpha=1),"icon"in i||(i.icon=s),"shadow"in i||(i.shadow=0),"shrink"in i||(i.shrink=1),!0===i.shrink&&(i.shrink=.7),"string"==typeof i.shrink&&(i.shrink=parseFloat(i.shrink)/(i.shrink.includes("%")?100:1));let n=0;for(let e=0;e<this.tabs.length;e++){this.tabs[e].dom.id===t&&n++}const o=function(t){const e=String(t).split(" ");for(let t=0;t<e.length;t++)e[t]=e[t][0].toUpperCase()+e[t].substring(1);return e.join(" ")}(t),r=new re(this,o,i);r.setId(t),r.count=n,this.tabs.push(r),this.tabsDiv.add(r);this.tabs.length>0&&this.tabsDiv.setDisplay("");const a=(new se).setId(t);return a.addClass("suey-tab-panel","suey-hidden"),a.add(e),a.count=n,this.panels.push(a),this.panelsDiv.add(a),this.setContentsStyle("minHeight",""),(this.tabsDiv.hasClass("suey-left-side")||this.tabsDiv.hasClass("suey-right-side"))&&this.setContentsStyle("minHeight",2.2*this.tabs.length+.4+"em"),a}selectFirst(){return this.tabs.length>0&&this.selectTab(this.tabs[0].getId())}selectLastKnownTab(){}selectTab(t,e=0,s=!1){if(null==this.tabs)return this;const i=this,n=this.tabs.find((function(s){return s.dom.id===t&&s.count===e})),o=this.panels.find((function(s){return s.dom.id===t&&s.count===e}));if(n&&o){s||m.setVariable("--tab-timing","0",n.dom);const r=this.tabs.find((function(t){return t.dom.id===i.selectedId&&t.count===i.selectedCount})),a=this.panels.find((function(t){return t.dom.id===i.selectedId&&t.count===i.selectedCount}));if(r&&r.removeClass("suey-selected"),a&&a.addClass("suey-hidden"),n.addClass("suey-selected"),o.removeClass("suey-hidden"),this.selectedId=t,this.selectedCount=e,s){const e=new Event("tab-changed");e.value=t,this.dom.dispatchEvent(e)}return s||setTimeout((()=>m.setVariable("--tab-timing","200ms",n.dom)),50),!0}return!1}destroy(){this.clearTabs(),super.destroy()}clearTabs(){if(this.tabsDiv&&this.tabsDiv.clearContents(),this.panelsDiv&&this.panelsDiv.clearContents(),this.tabs){for(let t=0;t<this.tabs.length;t++)this.tabs[t].destroy();this.tabs.length=0}if(this.panels){for(let t=0;t<this.panels.length;t++)this.panels[t].destroy();this.panels.length=0}this.setStyle("minHeight","")}currentId(){return this.selectedId}setTabSide(t){t=String(t).toLowerCase(),this.tabsDiv.removeClass("suey-left-side","suey-right-side"),this.tabsDiv.addClass(t===ie.RIGHT?"suey-right-side":"suey-left-side")}tabIndex(t){return this.tabs.indexOf(t)}}const oe=new v;class re extends ft{constructor(t,e,s={}){super();const i=this;if(this.setClass("suey-tab-button"),this.setStyle("cursor","default"),s.shadow&&this.addClass("suey-tab-shadow"),this.iconVector=new vt(s.icon),this.iconBorder=(new ft).setClass("suey-tab-icon-border"),this.add(this.iconVector,this.iconBorder),this.setLabel=function(t){i.iconBorder.dom.setAttribute("tooltip",t)},this.setLabel(e),"string"==typeof s.color&&s.color.includes("var(--"))this.iconVector.setStyle("background-color",`rgba(${s.color}, ${s.alpha})`);else{oe.set(s.color);const t=`linear-gradient(to bottom left, ${`rgba(${oe.rgbString(s.alpha)})`}, ${`rgba(${oe.darken(.75).rgbString(s.alpha)})`})`;this.iconVector.setStyle("background-image",t)}const n=s.shadow;if(this.iconVector.img&&!1!==n){oe.set(n);const t=`drop-shadow(0 0 var(--pad-micro) rgba(${oe.rgbString()}, 0.8))`;this.iconVector.img.setStyle("filter",t)}const o=s.shrink;this.iconVector.img&&!isNaN(o)&&(this.iconVector.img.setStyle("position","absolute"),this.iconVector.img.setStyle("left","0","right","0","top","0","bottom","0"),this.iconVector.img.setStyle("margin","auto"),this.iconVector.img.setStyle("width",100*o+"%"),this.iconVector.img.setStyle("height",100*o+"%")),this.onClick((()=>{t.selectTab(i.dom.id,i.count,!0),t.dom.dispatchEvent(new Event("resized"))}))}}const ae={TOP_LEFT:"top-left",TOP_RIGHT:"top-right",BOTTOM_LEFT:"bottom-left",BOTTOM_RIGHT:"bottom-right"};class he extends ft{#g={};constructor(){super();const t=this;let e=1;for(let s in ae){const i=ae[s],n=`suey-docker-${i}`,o=(new ft).addClass("suey-docker-corner").addClass(n);function r(){for(let e in t.#g){let s=getComputedStyle(t.#g[e].dom).getPropertyValue("z-index");s>1&&s--,t.#g[e].setStyle("zIndex",`${s}`)}o.setStyle("zIndex",`${Object.keys(t.#g).length}`)}o.setStyle("zIndex",`${e}`),e++,o.dom.addEventListener("pointerdown",r),o.dom.addEventListener("clicked",r),this.#g[i]=o,this.add(o)}}addDockPanel(t,e=ae.TOP_LEFT){if(!t)return;const s=this.getCorner(e);s.add(t),t.dom.addEventListener("resized",(()=>{s.dom.dispatchEvent(new Event("resized"))})),t.isElement&&(t.hasClass("suey-tabbed")&&(e.includes("right")&&t.setTabSide(ie.LEFT),e.includes("left")&&t.setTabSide(ie.RIGHT)),t.hasClass("suey-resizeable")&&(t.toggleResize(d.LEFT,e.includes("right")),t.toggleResize(d.RIGHT,e.includes("left"))))}getCorner(t=ae.TOP_LEFT){return this.#g[t]}}class de extends lt{constructor(){super(document.createElement("div")),this.addClass("suey-flex-box")}}class le extends Dt{constructor(){super(),this.setStyle("flex","1 1 auto"),this.setStyle("minHeight","0.01em")}}class ce extends gt{constructor(t,e,s=!0,i=!0){super(t);const n=this;switch(this.setClass("suey-toolbar-button"),this.setStyle("pointerEvents","all"),this.closesMenus=i,e){case"left":this.addClass("suey-button-left");break;case"middle":this.addClass("suey-button-middle");break;case"right":this.addClass("suey-button-right")}const o=(new ft).addClass("suey-button-background");s&&this.add(o);const r=(new bt).setStyle("pointer-events","none");function a(t){t.stopPropagation()}function h(t){t.stopPropagation()}this.add(r),this.contents=function(){return r},this.dom.addEventListener("pointerdown",a),this.dom.addEventListener("pointerup",h),this.dom.addEventListener("destroy",(()=>{n.dom.removeEventListener("pointerdown",a),n.dom.removeEventListener("pointerup",h)}),{once:!0})}onPointerDown(t){return console.trace(`ToolbarButton.onPointerDown() deprecated, use onClick() instead, from: ${this.getName()}`),this.onClick(t),this}onPointerUp(t){return console.trace(`ToolbarButton.onPointerUp() deprecated, use onClick() instead, from: ${this.getName()}`),this.onClick(t),this}onClick(t){if("function"!=typeof t)return;const e=this;t=t.bind(e);const s=function(s){s.preventDefault(),s.stopPropagation(),e.hasClass("suey-disabled")||(t(s),e.closesMenus&&document.dispatchEvent(new Event("closemenu")))},i=e.dom;return i.addEventListener("click",s),i.addEventListener("destroy",(()=>{i.removeEventListener("click",s)}),{once:!0}),e}}class ue extends lt{constructor(){super(document.createElement("div")),this.setClass("suey-toolbar-separator")}}class me extends lt{constructor(t=1){super(document.createElement("div")),this.setClass("suey-toolbar-spacer"),this.setStyle("width",`calc(var(--button-size) * ${t})`)}}const pe=new v;class ge extends se{#f=1;#y={x:0,y:0};#v={x:0,y:0};#b=0;#w=0;constructor({snapToGrid:t=!0,curveType:e=l.CURVE,gridType:s=c.LINES}={}){super();const i=this;this.activeItem=void 0,this.connectItem=void 0,this.activePoint={x:0,y:0},this.curveType=e,this.gridType=s,this.snapToGrid=t,this.input=(new ft).setClass("suey-graph-input"),this.grid=(new ft).setClass("suey-graph-grid"),this.nodes=(new ft).setClass("suey-graph-nodes"),this.lines=new Mt(2048,2048).setClass("suey-graph-lines"),this.bandbox=(new ft).setClass("suey-graph-band-box"),this.minimap=(new ft).setClass("suey-mini-map"),this.add(this.input,this.grid,this.lines,this.nodes,this.bandbox,this.minimap),this.mapCanvas=new Mt(1024,1024).setClass("suey-mini-map-canvas");const n=(new ft).addClass("suey-mini-map-resizers");this.minimap.add(this.mapCanvas,n),this.changeGridType(s),this.onWheel((function(t){t.preventDefault();const e=.001*t.deltaY;i.stopAnimation(),i.zoomTo(i.#f-e,t.clientX,t.clientY)})),window.addEventListener("resize",(function(){i.stopAnimation(),i.zoomTo()}));let o=!1,r=!1,a=!1;document.addEventListener("keydown",(function(t){i.isHidden()||" "===t.key&&(a=!0,i.dom.style.cursor=o?"grabbing":"grab",i.input.setStyle("z-index","100"))})),document.addEventListener("keyup",(function(t){i.isHidden()||" "===t.key&&(a=!1,i.dom.style.cursor="auto",i.input.setStyle("z-index","-1"))}));let h={x:0,y:0},u={x:0,y:0};function m(t){t.stopPropagation(),t.preventDefault(),i.dom.releasePointerCapture(t.pointerId),o&&(i.dom.style.cursor=a?"grab":"auto",o=!1),r&&(i.dom.dispatchEvent(new Event("selected")),i.bandbox.setStyle("display","none"),r=!1),i.dom.ownerDocument.removeEventListener("pointermove",p),i.dom.ownerDocument.removeEventListener("pointerup",m)}function p(t){if(t.stopPropagation(),t.preventDefault(),o){const e=(t.clientX-u.x)*(1/i.#f),s=(t.clientY-u.y)*(1/i.#f);i.#y.x=h.x+e,i.#y.y=h.y+s,i.zoomTo()}else r&&g(t.clientX,t.clientY)}function g(t,e){const s=i.input.dom.getBoundingClientRect(),n=Math.min(u.x,t)-s.left,o=Math.min(u.y,e)-s.top,r=Math.abs(u.x-t),a=Math.abs(u.y-e);i.bandbox.setStyle("left",`${n}px`,"top",`${o}px`,"width",`${r}px`,"height",`${a}px`);const h=i.dom.getBoundingClientRect(),d=h.left+(h.right-h.left)/2,l=h.top+(h.bottom-h.top)/2,c=(d-n)/d,m=(l-o)/l,p=d-h.width/i.#f/2*c-i.#y.x,g=l-h.height/i.#f/2*m-i.#y.y,f=p+r/i.#f,y=g+a/i.#f;const v=[],b=i.getNodes();b.forEach((t=>{(function(t){return f>=t.left&&p<=t.right&&g<=t.bottom&&y>=t.top})(t)&&v.push(t)})),b.forEach((t=>{v.includes(t)?t.addClass("suey-node-selected"):t.removeClass("suey-node-selected")}))}this.input.onPointerDown((function(t){if(i.stopAnimation(),u.x=t.clientX,u.y=t.clientY,2===t.button||0===t.button&&a)o=!0,i.dom.style.cursor="grabbing",h.x=i.#y.x,h.y=i.#y.y;else if(0===t.button){r=!0;document.querySelectorAll(".suey-node-selected").forEach((t=>t.classList.remove("suey-node-selected"))),i.bandbox.setStyle("display","block"),g(t.clientX,t.clientY)}(o||r)&&(i.dom.setPointerCapture(t.pointerId),i.dom.ownerDocument.addEventListener("pointermove",p),i.dom.ownerDocument.addEventListener("pointerup",m))}));let f={};Et.makeResizeable(this.minimap,n,[d.LEFT,d.TOP],(function(){f=i.minimap.dom.getBoundingClientRect()}),(function(t,e,s){if(t.hasClassWithString("left")){const t=Math.max(0,Math.min(f.right-100,f.left+e)),s=f.right-t;i.minimap.setStyle("left",`${t}px`),i.minimap.setStyle("width",`${s}px`)}if(t.hasClassWithString("top")){const t=Math.max(0,Math.min(f.bottom-100,f.top+s)),e=f.bottom-t;i.minimap.setStyle("top",`${t}px`),i.minimap.setStyle("height",`${e}px`)}if(t.hasClassWithString("right")){const t=Math.min(Math.max(100,f.width+e),window.innerWidth-f.left);i.minimap.setStyle("width",`${t}px`)}if(t.hasClassWithString("bottom")){const t=Math.min(Math.max(100,f.height+s),window.innerHeight-f.top);i.minimap.setStyle("height",`${t}px`)}i.drawMiniMap(),i.drawLines()}));let y=!1;function v(t,e){const s=i.minimap.dom.getBoundingClientRect(),n=i.nodes.dom.getBoundingClientRect(),o=(s.width/2-(t-s.left))/(s.width/2),r=(s.height/2-(e-s.top))/(s.height/2),a=i.nodeBounds(100,i.nodes.children,1200);if(a.isFinite){if(i.#b>i.#w){const t=i.#b/i.#w,e=a.center().x-a.width()/2*o,s=a.center().y-a.height()/2*t*r;i.#y.x=n.width/2/i.#f-e,i.#y.y=n.height/2/i.#f-s}else{const t=i.#w/i.#b,e=a.center().x-a.width()/2*t*o,s=a.center().y-a.height()/2*r;i.#y.x=n.width/2/i.#f-e,i.#y.y=n.height/2/i.#f-s}i.zoomTo()}}this.minimap.onPointerDown((function(t){i.stopAnimation(),i.minimap.dom.setPointerCapture(t.pointerId),i.minimap.setStyle("cursor","grabbing"),v(t.clientX,t.clientY),y=!0})),this.minimap.onPointerUp((function(t){i.minimap.dom.releasePointerCapture(t.pointerId),i.minimap.setStyle("cursor","grab"),y=!1})),this.minimap.onPointerMove((function(t){y&&v(t.clientX,t.clientY)}))}getScale(){return this.#f}addNode(){for(let t=0,e=arguments.length;t<e;t++){const e=arguments[t];this.nodes&&(e.graph=this,this.nodes.add(e),e.setStyle("zIndex",this.nodes.children.length))}this.drawMiniMap(),this.drawLines()}getNodes(){return this.nodes.children}removeNode(t){if(!t||!t.isElement)return;const e=t.zIndex,s=this.nodes.children.length;this.nodes.remove(t);s!==this.nodes.children.length&&(this.nodes.children.forEach((t=>{t.zIndex>e&&t.setStyle("zIndex",""+(t.zIndex-1))})),this.drawMiniMap(),this.drawLines())}nodeBounds(t=0,e=this.nodes.children,s=void 0){const i={x:{min:1/0,max:-1/0},y:{min:1/0,max:-1/0},isFinite:!1,center:function(){return{x:0,y:0}}};if(e.forEach((t=>{i.x.min=Math.min(i.x.min,t.left),i.x.max=Math.max(i.x.max,t.right),i.y.min=Math.min(i.y.min,t.top),i.y.max=Math.max(i.y.max,t.bottom)})),i.x.max>i.x.min&&i.y.max>i.y.min&&(i.isFinite=!0,i.center=function(){return{x:i.x.min+(i.x.max-i.x.min)/2,y:i.y.min+(i.y.max-i.y.min)/2}},i.width=()=>i.x.max-i.x.min,i.height=()=>i.y.max-i.y.min,i.x.min-=t,i.x.max+=t,i.y.min-=t,i.y.max+=t,s)){if(i.width()<s){const t=(s-i.width())/2;i.x.min-=t,i.x.max+=t}if(i.height()<s){const t=(s-i.height())/2;i.y.min-=t,i.y.max+=t}}return i}traverseNodes(t){if("function"!=typeof t)return;if(!this.nodes)return;const e=this.nodes.children;e.sort(((t,e)=>t.zIndex-e.zIndex));for(let s=0;s<e.length;s++){const i=e[s];i&&i.isNode&&t(i)}}changeGridType(t=c.LINES){const e=100,s=50;if(this.gridType=t,t===c.LINES){const t=new Mt(e,e),i=t.ctx;i.clearRect(0,0,t.width,t.height),i.globalAlpha=.55,i.fillStyle=pe.set(rt.color(h.BUTTON_LIGHT)).cssString(),i.fillRect(0,0,50,50),i.fillRect(50,50,50,50),i.globalAlpha=.45,i.fillStyle=pe.set(rt.color(h.BUTTON_LIGHT)).cssString(),i.fillRect(50,0,50,50),i.fillRect(0,50,50,50),i.globalAlpha=1,i.lineWidth=0,i.strokeStyle=pe.set(rt.color(h.BACKGROUND_LIGHT)).cssString(),i.strokeRect(0,0,s,s),i.strokeRect(s,s,s,s),i.strokeRect(s,0,s,s),i.strokeRect(0,s,s,s),this.grid.setStyle("background-image",`url('${t.dom.toDataURL()}')`),this.grid.setStyle("background-size",n*this.#f*2+"px")}else if(t===c.DOTS){const t=4,i=new Mt(e,e),o=i.ctx;o.globalAlpha=.5,o.fillStyle=pe.set(rt.color(h.BUTTON_LIGHT)).cssString(),o.fillRect(0,0,i.width,i.height),o.fillStyle=pe.set(rt.color(h.BUTTON_LIGHT)).cssString();for(let e=0;e<3;e++)for(let i=0;i<3;i++)o.beginPath(),o.ellipse(s*e,s*i,t,t,0,0,2*Math.PI),o.fill();this.grid.setStyle("background-image",`url('${i.dom.toDataURL()}')`),this.grid.setStyle("background-size",n*this.#f*2+"px")}}connect(){if(this.activeItem&&this.connectItem){const t=this.activeItem,e=this.connectItem;t.type===u.OUTPUT?t.connect(e):e.type===u.OUTPUT&&e.connect(t)}this.activeItem=void 0,this.connectItem=void 0,this.drawLines()}disconnect(t){this.traverseNodes((e=>{e.outputList.children.forEach((e=>{const s=e.connections.indexOf(t);s>-1&&(e.connections.splice(s,1),t.reduceIncoming()),0===e.connections.length&&e.removeClass("suey-item-connected")}))}))}drawLines(){if(!this.lines)return;if(this.isHidden())return;const t=this,e=this.lines,s=e.dom.getBoundingClientRect(),i=s.left,n=s.right,o=s.top,r=s.bottom,a=e.ctx;function h(t){return t/s.width*e.width}function d(t){return t/s.height*e.height}function c(e,s,c,u,m=10,p="#ffffff",g=p,f=!1){if(n>=(e<c?e:c)&&i<=(e<c?c:e)&&o<=(s<u?u:s)&&r>=(s<u?s:u)){if(e=h(e),s=d(s),c=h(c),u=d(u),a.globalAlpha=1,f){const t=h(m),i=d(m);a.fillStyle=p,a.beginPath(),a.ellipse(e,s,t,i,0,0,2*Math.PI),a.fill(),a.fillStyle=g,a.beginPath(),a.ellipse(c,u,t,i,0,0,2*Math.PI),a.fill()}!function(e,s,i,n,o,r=o){if(Number.isFinite(e)&&!Number.isNaN(e)&&Number.isFinite(i)&&!Number.isNaN(i)&&Number.isFinite(s)&&!Number.isNaN(s)&&Number.isFinite(n)&&!Number.isNaN(n)){if(a.strokeStyle=o,null!=r&&o!==r){const t=a.createLinearGradient(e,s,i,n);t.addColorStop(0,o),t.addColorStop(1,r),a.strokeStyle=t}switch(a.lineWidth=4*t.#f,a.beginPath(),a.moveTo(e,s),t.curveType){case l.STRAIGHT:a.lineTo(i,n);break;case l.ZIGZAG:const t=Math.abs(.25*(i-e));a.lineTo(e+t,s),a.lineTo(i-t,n),a.lineTo(i,n);break;default:const o=Math.abs(.5*(i-e));a.bezierCurveTo(e+o,s,i-o,n,i,n)}a.stroke()}}(e,s,c,u,p,g)}}a.clearRect(0,0,e.width,e.height);const p=parseFloat(m.toPx("0.21429em",this.dom))*this.#f;if(this.traverseNodes((t=>{t.outputList&&t.outputList.children.forEach((t=>{const e=t.point.dom.getBoundingClientRect(),s=e.left+e.width/2,i=e.top+e.height/2,n=t.node.colorString();t.connections.forEach((t=>{const e=t.point.dom.getBoundingClientRect(),o=e.left+e.width/2,r=e.top+e.height/2,a=t.node.colorString();c(s,i,o,r,p,n,a)}))}))})),this.activeItem){const t=this.activeItem.point.dom.getBoundingClientRect(),e=t.left+t.width/2,s=t.top+t.height/2,i=this.activePoint.x,n=this.activePoint.y,o=this.activeItem.node.colorString(),r=this.activeItem.type===u.OUTPUT,a=!this.connectItem;r?c(e,s,i,n,p,o,o,a):c(i,n,e,s,p,o,o,a)}}drawMiniMap(){if(!this.mapCanvas)return;if(this.isHidden())return;const t=this.mapCanvas,e=t.ctx;e.clearRect(0,0,t.width,t.height);const s=this.nodeBounds(100,this.nodes.children,1200);if(!s.isFinite)return;this.#b=t.width,this.#w=t.height;let i=0,n=0;const o=t.width/s.width(),r=t.height/s.height()*this.mapCanvas.ratio();o>r?(this.#b*=r/o,i=(this.#b-t.width)/2):(this.#w*=o/r,n=(this.#w-t.height)/2);const a=this.dom.getBoundingClientRect(),d={},l=a.left+(a.right-a.left)/2,c=a.top+(a.bottom-a.top)/2;d.left=l-a.width/this.#f/2-this.#y.x,d.top=c-a.height/this.#f/2-this.#y.y,d.width=a.width/this.#f,d.height=a.height/this.#f;const u=this.#b*((d.left-s.x.min)/s.width())-i,m=this.#w*((d.top-s.y.min)/s.height())-n,p=this.#b*(d.width/s.width()),g=this.#w*(d.height/s.height());e.globalAlpha=.5,e.fillStyle=pe.set(rt.color(h.BUTTON_LIGHT)).cssString(),e.fillRect(u,m,p,g);const f=this.minimap.getWidth()/this.mapCanvas.width,y=this.minimap.getHeight()/this.mapCanvas.height;e.globalAlpha=.75,e.strokeStyle=pe.set(rt.color(h.TEXT)).cssString(),e.lineWidth=2/f,e.beginPath(),e.moveTo(u+0,m),e.lineTo(u+0,m+g),e.stroke(),e.beginPath(),e.moveTo(u+p,m),e.lineTo(u+p,m+g),e.stroke(),e.lineWidth=2/y,e.beginPath(),e.moveTo(u,m+0),e.lineTo(u+p,m+0),e.stroke(),e.beginPath(),e.moveTo(u,m+g),e.lineTo(u+p,m+g),e.stroke(),e.globalAlpha=.5,e.globalAlpha=.75,this.traverseNodes((t=>{e.fillStyle=t.colorString();const o=this.#b*((t.left-s.x.min)/s.width()),r=this.#b*(t.width/s.width()),a=this.#w*((t.top-s.y.min)/s.height()),h=this.#w*(t.height/s.height());e.beginPath(),e.roundRect(o-i,a-n,r,h,0),e.fill()}))}centerView(t=!0,e=!0){const s=[];this.traverseNodes((t=>{t.hasClass("suey-node-selected")&&s.push(t)}));const i=this.nodeBounds(0,s.length>0?s:this.nodes.children);this.focusView(i.center().x,i.center().y,t,e)}focusView(t,e,s=!1,i=!0){if(null==t||null==e)return;const n=this.nodes.dom.getBoundingClientRect();if(this.#x=n.width/2/this.#f-t,this.#C=n.height/2/this.#f-e,this.#E=1e3*(s?1:this.#f),i){const t=this;this.#S=performance.now(),this.#T=performance.now(),this.#L=1e3*this.#f,this.#I=setInterval((()=>{function e(t,e,s,i){return function(t,e,s){return(1-s)*t+s*e}(t,e,1-Math.exp(-s*i))}this.#k=!0;const s=(performance.now()-t.#S)/1e3,i=(performance.now()-t.#T)/1e3;t.#y.x=e(t.#y.x,t.#x,15,i),t.#y.y=e(t.#y.y,t.#C,15,i),t.#L=e(t.#L,t.#E,15*(s+.5),i);const n=Math.abs(t.#y.x-t.#x),o=Math.abs(t.#y.y-t.#C),r=Math.abs(t.#L-t.#E);n<.5&&o<.5&&r<.01&&t.stopAnimation(),s>2.5&&t.stopAnimation(),t.zoomTo(t.#L/1e3),t.#T=performance.now()}),4)}else this.#y.x=this.#x,this.#y.y=this.#C,this.zoomTo(this.#E/1e3)}#k=!1;#I=void 0;#S=0;#T=0;#x=0;#C=0;#L=0;#E=0;stopAnimation(){clearInterval(this.#I),this.#k&&(this.#k=!1,this.#y.x=this.#x,this.#y.y=this.#C,this.zoomTo(this.#E/1e3))}zoomTo(t,e,s){void 0===t&&(t=this.#f),t=Math.round(100*Math.min(Math.max(t,.1),4))/100;const i=this.nodes,o=this.grid;if(null!=e&&null!=s){const n=i.dom.getBoundingClientRect();i.setStyle("transform",`scale(${t}) translate(${this.#y.x}px, ${this.#y.y}px)`);const o=i.dom.getBoundingClientRect();e-=n.left,s-=n.top;const r=o.left-n.left,a=o.top-n.top,h=e-e/this.#f*t,d=s-s/this.#f*t;this.#y.x-=(r-h)/t,this.#y.y-=(a-d)/t}i.setStyle("transform",`scale(${t}) translate(${this.#y.x}px, ${this.#y.y}px)`),this.#f=t,this.#v.x=this.#y.x,this.#v.y=this.#y.y;const r=this.dom.getBoundingClientRect(),a=(r.width-r.width*t)/2,h=(r.height-r.height*t)/2,d=this.#y.x*t,l=this.#y.y*t;o.setStyle("background-position",`left ${a+d}px top ${h+l}px`),o.setStyle("background-size",n*this.#f*2+"px"),o.setStyle("opacity",this.#f<1?this.#f*this.#f:"1");document.querySelectorAll(".suey-node").forEach((e=>{t<.5?e.classList.add("suey-too-small"):e.classList.remove("suey-too-small")})),this.drawMiniMap(),this.drawLines()}}const fe=new v,ye=new v;class ve extends ft{#R=new v;#M={};#D=!0;#H={x:0,y:0};constructor({width:t=200,height:e=150,x:s=0,y:i=0,color:n=8947848,resizers:o=[d.TOP,d.BOTTOM,d.LEFT,d.RIGHT]}={}){super();const r=this;this.addClass("suey-node"),this.dom.setAttribute("tabindex","-1"),this.isNode=!0,this.graph=void 0,this.#R.set(n);const a=(new ft).addClass("suey-node-panel"),h=(new ft).addClass("suey-node-border"),l=(new ft).addClass("suey-node-resizers");this.addToSelf(l,a,h),this.contents=function(){return a},this.header=(new ft).setClass("suey-node-header-title").setStyle("display","none");const c=(new ft).setClass("suey-node-interior");this.inputList=(new ft).setClass("suey-node-item-list"),this.outputList=(new ft).setClass("suey-node-item-list"),c.add(this.inputList,this.outputList),this.add(this.header,c),this.dom.addEventListener("focusout",(()=>r.removeClass("suey-active-node"))),this.dom.addEventListener("focusin",(()=>r.activeNode())),this.dom.addEventListener("displayed",(()=>r.activeNode())),this.dom.addEventListener("pointerdown",(()=>r.activeNode())),this.onContextMenu((function(t){t.preventDefault()}));let u,m={};Et.makeResizeable(this,l,o,(function(){m.left=r.left,m.top=r.top,m.width=r.width,m.height=r.height,v()}),(function(t,e,s){const i=r.getScale();if(e*=1/i,s*=1/i,t.hasClassWithString("left")){const t=Math.max(r.roundNearest(m.width-e),200),s=m.left+(m.width-t);r.setStyle("left",`${s}px`,"width",`${t}px`)}if(t.hasClassWithString("top")){const t=Math.max(r.roundNearest(m.height-s),100),e=m.top+(m.height-t);r.setStyle("top",`${e}px`,"height",`${t}px`)}if(t.hasClassWithString("right")){const t=Math.max(r.roundNearest(m.width+e),200);r.setStyle("width",`${t}px`)}if(t.hasClassWithString("bottom")){const t=Math.max(r.roundNearest(m.height+s),100);r.setStyle("height",`${t}px`)}}));const p=new MutationObserver((()=>{r.needsUpdate=!0,clearTimeout(u),u=setTimeout((()=>r.#A()),4)}));p.observe(this.dom,{attributes:!0,attributeFilter:["style","class"]}),this.setStyle("left",`${this.roundNearest(parseFloat(s))}px`,"top",`${this.roundNearest(parseFloat(i))}px`,"width",`${parseFloat(t)}px`,"height",`${parseFloat(e)}px`);let g,f=0,y=!1;function v(t){if(f++,t&&0!==t.button)return void(r.graph&&setTimeout((()=>r.graph.input.dom.dispatchEvent(t)),0));if(r.graph){const t=r.graph.getNodes();r.zIndex!==t.length&&(t.forEach((t=>t.setStyle("zIndex",""+(t.zIndex-1)))),r.setStyle("zIndex",t.length))}const e=document.querySelectorAll(".suey-node-selected");r.hasClass("suey-node-selected")?e.length>1&&(y=!0):(e.forEach((t=>{t!==r.dom&&t.classList.remove("suey-node-selected")})),r.addClass("suey-node-selected"),r.graph&&r.graph.dom.dispatchEvent(new Event("selected")),y=!1),r.dom.ownerDocument.addEventListener("pointerup",b)}function b(){clearTimeout(g),g=setTimeout((()=>{if(y&&1===f){document.querySelectorAll(".suey-node-selected").forEach((t=>{t!==r.dom&&t.classList.remove("suey-node-selected")})),r.addClass("suey-node-selected"),r.graph&&r.graph.dom.dispatchEvent(new Event("selected"))}f=0,y=!1}),250),r.dom.ownerDocument.removeEventListener("pointerup",b)}Et.makeDraggable(r,r,!1,(function(){r.graph&&r.graph.getNodes().forEach((t=>t.setStartPosition(t.left,t.top)))}),(function(t,e){y=!1,f=0,r.graph&&r.graph.getNodes().forEach((s=>{s.hasClass("suey-node-selected")&&(s.setStyle("left",`${r.roundNearest(s.getStartPosition().x+t)}px`),s.setStyle("top",`${r.roundNearest(s.getStartPosition().y+e)}px`))}))}),(function(){r.graph&&r.dom.dispatchEvent(new Event("dragged"))})),this.onPointerDown(v),this.onDblClick((function(){r.graph&&r.graph.centerView(!1,!0)})),this.dom.addEventListener("destroy",(function(){p&&p.disconnect()}),{once:!0})}get needsUpdate(){return this.#D}set needsUpdate(t){this.#D=t}#A(){if(!this.#D)return;const t=getComputedStyle(this.dom),e=this.#M;e.left=parseFloat(t.left),e.top=parseFloat(t.top),e.width=parseFloat(t.width),e.height=parseFloat(t.height),e.right=e.left+e.width,e.bottom=e.top+e.height,e.zIndex=parseInt(t.zIndex),this.#D=!1;const s=this;this.graph&&setTimeout((()=>{s.graph.drawMiniMap(),s.graph.drawLines()}),20)}get left(){return this.#A(),this.#M.left}get top(){return this.#A(),this.#M.top}get width(){return this.#A(),this.#M.width}get height(){return this.#A(),this.#M.height}get right(){return this.#A(),this.#M.right}get bottom(){return this.#A(),this.#M.bottom}get zIndex(){return this.#A(),this.#M.zIndex}roundNearest(t,e=25){return this.graph&&this.graph.snapToGrid?Math.round(t/e)*e:t}getScale(){return this.graph?this.graph.getScale():1}getStartPosition(){return this.#H}setStartPosition(t=0,e=0){this.#H.x=t,this.#H.y=e}addItem(t){switch(t.node=this,t.type){case u.INPUT:this.inputList.add(t);break;case u.OUTPUT:this.outputList.add(t)}}createHeader(t="",e){if(this.header.children.length>0)return;const s=new vt(e),i=(new Dt).setClass("suey-node-header-icon").add(s),n=(new Dt).setClass("suey-node-header-text").setTextContent(t);this.header.add(i,n),this.header.setStyle("display",""),this.applyColor(),this.name=t}activeNode(t="suey-node"){const e=this.dom;document.querySelectorAll(`.${t}`).forEach((t=>{t!==e&&t.classList.remove("suey-active-node")})),e.classList.add("suey-active-node")}applyColor(t){void 0!==t&&this.#R.set(t);const e=ye.set(this.#R).darken(1.3).rgbString(),s=fe.set(this.#R).darken(.7).rgbString();this.header&&this.header.setStyle("background-image",`linear-gradient(to bottom, rgba(${e}, 0.75), rgba(${s}, 0.75))`),m.setVariable("--node-color",fe.set(this.#R).rgbString(),this.dom)}colorString(){return this.#R.cssString()}}class be extends ft{constructor({quantity:t=1,type:s=u.INPUT,title:i=""}={}){super(i);const n=this;this.addClass("suey-node-item");const o=new vt(e);switch(this.point=(new ft).addClass("suey-node-item-point"),this.detach=(new ft).addClass("suey-node-item-detach").add(o),this.add(this.point,this.detach),this.connections=[],this.incoming=0,this.quantity=t,this.type=s,this.node=this,s){case u.INPUT:this.addClass("suey-node-left");break;case u.OUTPUT:this.addClass("suey-node-right")}function r(t){t.stopPropagation(),t.preventDefault(),n.point.removeClass("suey-active-item"),n.graph().connect(),n.point.dom.ownerDocument.removeEventListener("pointermove",a),n.point.dom.ownerDocument.removeEventListener("pointerup",r)}function a(t){t.stopPropagation(),t.preventDefault(),n.graph().activePoint.x=t.clientX,n.graph().activePoint.y=t.clientY,n.graph().drawLines()}this.graph=()=>n.node&&n.node.graph?n.node.graph:void 0,this.point.onPointerDown((function(t){0===t.button&&n.graph()&&(t.stopPropagation(),t.preventDefault(),n.point.dom.ownerDocument.addEventListener("pointermove",a),n.point.dom.ownerDocument.addEventListener("pointerup",r),n.point.addClass("suey-active-item"),n.graph().activeItem=n,n.graph().activePoint.x=t.clientX,n.graph().activePoint.y=t.clientY,n.graph().drawLines())})),this.point.onPointerEnter((function(t){n.graph()&&n.graph().activeItem?n.type!==n.graph().activeItem.type&&(n.graph().connectItem=n,n.graph().activeItem&&n.point.addClass("suey-active-item"),n.point.addClass("suey-hover-point")):n.point.addClass("suey-hover-point")})),this.point.onPointerLeave((function(t){n.graph()&&(n.graph().connectItem=void 0,n.graph().activeItem!==n&&n.point.removeClass("suey-active-item")),n.point.removeClass("suey-hover-point")})),this.detach.onPointerDown((function(t){n.hasClass("suey-item-connected")&&0===t.button&&(t.stopPropagation(),t.preventDefault(),n.disconnect())}))}connect(t){t!==this&&(this.connections.includes(t)||(this.connections.length>=this.quantity&&(this.connections[this.connections.length-1].reduceIncoming(),this.connections.length=Math.max(0,this.connections.length-1)),this.connections.length<this.quantity&&(t.increaseIncoming(),this.connections.push(t))),this.connections.length>0?this.addClass("suey-item-connected"):this.removeClass("suey-item-connected"))}disconnect(){switch(this.type){case u.OUTPUT:for(let t=0;t<this.connections.length;t++)this.connections[t].reduceIncoming();this.connections.length=0;break;case u.INPUT:this.graph()&&this.graph().disconnect(this)}this.removeClass("suey-item-connected"),this.graph()&&this.graph().drawLines()}increaseIncoming(){this.incoming++,this.addClass("suey-item-connected")}reduceIncoming(){this.incoming>0&&this.incoming--,0===this.incoming&&this.removeClass("suey-item-connected")}}class we extends se{constructor({text:t="",icon:e="",arrow:s="left",border:i=!0}={}){super();const n=this;this.addClass("suey-shrinkable"),i||this.addClass("suey-borderless"),this.titleDiv=void 0,this.bodyDiv=void 0;const o=(new ft).setClass("suey-shrink-title"),r=(new Dt).setClass("suey-shrink-arrow"),a=(new ft).addClass("suey-shrink-arrow-clicker");r.add(a);const h=(new Dt).setClass("suey-shrink-text").setInnerHtml(t),d=(new Dt).setClass("suey-shrink-icon");e&&d.addClass("suey-has-icon");const l=new vt(e);d.add(l),"right"===s?o.add(d,h,r):o.add(r,d,h);const c=(new ft).setClass("suey-shrink-body");this.add(o),this.add(c),this.titleDiv=o,this.bodyDiv=c,this.contents=function(){return n.bodyDiv},this.setExpanded(!0,!1),a.onClick((function(){n.toggle()}))}setExpanded(t=!0,e=!0){t=Boolean(t),this.isExpanded=t,t?this.addClass("suey-expanded"):this.removeClass("suey-expanded"),e&&this.dom.dispatchEvent(new Event("expand"))}sort(){const t=this.contents().children;t.sort(((t,e)=>t.name<e.name?-1:t.name>e.name?1:0));for(let e=0;e<t.length;e++)t[e].setStyle("order",e)}toggle(){this.setExpanded(!this.isExpanded)}}class xe extends se{constructor({title:t,collapsible:e=!1}={}){super();const s=this;if(this.addClass("suey-titled"),this.addClass("suey-expanded"),this.isExpanded=!0,this.tabTitle=new ft(t).addClass("suey-tab-title"),t&&""!==t&&this.add(this.tabTitle),e){this.tabTitle.setStyle("pointer-events","all");const t=(new ft).setClass("suey-title-arrow-click");t.add((new ft).setClass("suey-title-arrow")),this.tabTitle.add(t),t.onClick((()=>{s.toggle()}))}this.scroller=(new ft).addClass("suey-scroller"),this.add(this.scroller),this.contents=function(){return this.scroller}}setExpanded(t=!0){this.isExpanded=t,t?(this.addClass("suey-expanded"),this.scroller.setDisplay("")):(this.removeClass("suey-expanded"),this.scroller.setDisplay("none"))}toggle(){this.setExpanded(!this.isExpanded)}}class Ce extends se{#N;#P;#O;#F=!1;#B=void 0;constructor({style:t=ee.FANCY,width:e=600,height:s=600,resizers:i=[d.TOP,d.BOTTOM,d.LEFT,d.RIGHT]}={}){super({style:t});const n=this;this.addClass("suey-window"),this.allowFocus(),this.isWindow=!0,this.#N=e,this.#P=s,this.dom.addEventListener("focusout",(()=>{n.removeClass("suey-active-window")})),this.dom.addEventListener("focusin",(()=>{n.activeWindow()})),this.dom.addEventListener("displayed",(()=>{n.activeWindow()})),this.dom.addEventListener("pointerdown",(()=>{n.activeWindow()}));let o={};function r(){const t=getComputedStyle(n.dom),e={left:parseFloat(t.left),top:parseFloat(t.top),width:parseFloat(t.width),height:parseFloat(t.height)},s=parseInt(m.toPx("4em"));let i=Math.min(window.innerWidth-e.width/2,e.left),o=Math.min(window.innerHeight-s,e.top);i=Math.max(-e.width/2,i),o=Math.max(0,o),n.setStyle("top",`${o}px`),n.setStyle("left",`${i}px`)}Et.makeResizeable(this,this,i,(function(){n.focus(),o=n.dom.getBoundingClientRect()}),(function(t,e,s){if(t.hasClassWithString("left")){const t=Math.max(0,Math.min(o.right-300,o.left+e)),s=o.right-t;n.setStyle("left",`${t}px`),n.setStyle("width",`${s}px`)}if(t.hasClassWithString("top")){const t=Math.max(0,Math.min(o.bottom-150,o.top+s)),e=o.bottom-t;n.setStyle("top",`${t}px`),n.setStyle("height",`${e}px`)}if(t.hasClassWithString("right")){const t=Math.min(Math.max(300,o.width+e),window.innerWidth-o.left);n.setStyle("width",`${t}px`)}if(t.hasClassWithString("bottom")){const t=Math.min(Math.max(150,o.height+s),window.innerHeight-o.top);n.setStyle("height",`${t}px`)}n.dom.dispatchEvent(new Event("resizer"))}),(function(){r()})),this.setStyle("left","0","top","0","width","0","height","0"),"complete"===document.readyState?n.setInitialSize():window.addEventListener("load",(()=>{n.setInitialSize()}),{once:!0}),window.addEventListener("resize",(()=>{r()}));let a=!0;this.dom.addEventListener("displayed",(()=>{a&&(n.center(),a=!1),r()}))}addTitleBar(t="",e=!1,s=1.3){this.#B?this.#B.setTitle(t):(this.#B=new Ee(this,t,e,s),this.addToSelf(this.#B))}setTitle(t=""){this.#B&&this.#B.setTitle(t)}activeWindow(){if(this.hasClass("suey-active-window"))return;this.addClass("suey-active-window");const t=document.querySelectorAll(".suey-window");t.forEach((t=>{t!==this.dom&&t.classList.remove("suey-active-window")}));const e=t.length+200;m.setVariable("--window-z-index",`${e}`,this),t.forEach((t=>{if(t!==this.dom){let s=m.getVariable("--window-z-index",t);s>=e&&(s=e),s--,s<200&&(s=200),m.setVariable("--window-z-index",`${s}`,t)}}))}center(){const t=(window.innerWidth-this.getWidth())/2,e=(window.innerHeight-this.getHeight())/2;this.setStyle("left",`${t}px`,"top",`${e}px`)}setInitialSize(){const t=m.toPx(m.parseSize(this.#N),this,"w"),e=m.toPx(m.parseSize(this.#P),this,"h");this.setStyle("width",t),this.setStyle("height",e),this.dom.dispatchEvent(new Event("resizer"))}showWindow(){this.display(),this.focus()}toggleMinMax(){if(this.#F){const t=Math.max(0,Math.min(window.innerWidth-this.#O.width,this.#O.left)),e=Math.max(0,Math.min(window.innerHeight-this.#O.height,this.#O.top));this.setStyle("left",`${t}px`),this.setStyle("top",`${e}px`),this.setStyle("width",`${this.#O.width}px`),this.setStyle("height",`${this.#O.height}px`),this.#F=!1}else this.#O=this.dom.getBoundingClientRect(),this.setStyle("left","0"),this.setStyle("top","0"),this.setStyle("width",`${window.innerWidth}px`),this.setStyle("height",`${window.innerHeight}px`),this.#F=!0;this.dom.dispatchEvent(new Event("resizer"))}}class Ee extends ft{constructor(t,e="",s=!1,i=1.3){if(!t||!t.isElement)return console.warn("TitleBar: Missing parent element");super();const n=this;this.setClass("suey-title-bar"),this.addClass("suey-panel-button"),this.setStyle("height",`${i}em`,"width",6*i+"em"),this.setStyle("top",.8-(i+.28571+.071)/2+"em"),this.setTitle(e),s&&Et.makeDraggable(this,t,!0,(function(){t&&"function"==typeof t.focus&&t.focus()})),this.onDblClick((()=>{n.parent&&n.parent.isElement&&("function"==typeof n.parent.setInitialSize&&n.parent.setInitialSize(),"function"==typeof n.parent.center&&n.parent.center(),window.dispatchEvent(new Event("resize")))}))}setTitle(t=""){this.setInnerHtml(t);let e=parseFloat(m.getTextWidth(t,m.getFontCssFromElement(this.dom)));e+=parseFloat(m.toPx("4em")),this.setStyle("width",m.toEm(`${e}px`))}}export{p as ALIGN,Qt as AbsoluteBox,te as AssetBox,r as BACKGROUNDS,Rt as Break,gt as Button,wt as CLOSE_SIDES,ae as CORNERS,Mt as Canvas,Ft as Checkbox,$t as Color,rt as ColorScheme,m as Css,ft as Div,he as Docker,_t as Dropdown,lt as Element,de as FlexBox,le as FlexSpacer,c as GRAPH_GRID_TYPES,l as GRAPH_LINE_TYPES,n as GRID_SIZE,ge as Graph,t as IMAGE_CHECK,e as IMAGE_CLOSE,s as IMAGE_EMPTY,i as IMAGE_EXPAND,yt as Image,Et as Interaction,v as Iris,Nt as LEFT_SPACING,zt as Menu,Ut as MenuItem,Gt as MenuSeparator,Wt as MenuShortcut,u as NODE_TYPES,ve as Node,be as NodeItem,Yt as NumberBox,Xt as NumberScroll,g as OVERFLOW,ee as PANEL_STYLES,f as POSITION,se as Panel,y as Popper,Pt as PropertyList,d as RESIZERS,At as Row,bt as ShadowBox,we as Shrinkable,ht as Signal,at as SignalBinding,Zt as Slider,Dt as Span,ie as TAB_SIDES,a as THEMES,o as TOOLTIP_Y_OFFSET,h as TRAIT,ne as Tabbed,Ht as Text,jt as TextArea,Jt as TextBox,xe as Titled,ce as ToolbarButton,ue as ToolbarSeparator,me as ToolbarSpacer,Ot as TreeList,St as Utils,vt as VectorBox,Ce as Window,kt as tooltipper};
